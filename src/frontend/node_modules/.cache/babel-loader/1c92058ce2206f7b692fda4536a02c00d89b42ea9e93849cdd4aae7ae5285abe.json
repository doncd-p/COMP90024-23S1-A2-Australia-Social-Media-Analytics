{"ast":null,"code":"/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar zrUtil = require(\"zrender/lib/core/util\");\nvar pathTool = require(\"zrender/lib/tool/path\");\nvar colorTool = require(\"zrender/lib/tool/color\");\nvar matrix = require(\"zrender/lib/core/matrix\");\nvar vector = require(\"zrender/lib/core/vector\");\nvar Path = require(\"zrender/lib/graphic/Path\");\nvar Transformable = require(\"zrender/lib/mixin/Transformable\");\nvar ZImage = require(\"zrender/lib/graphic/Image\");\nexports.Image = ZImage;\nvar Group = require(\"zrender/lib/container/Group\");\nexports.Group = Group;\nvar Text = require(\"zrender/lib/graphic/Text\");\nexports.Text = Text;\nvar Circle = require(\"zrender/lib/graphic/shape/Circle\");\nexports.Circle = Circle;\nvar Sector = require(\"zrender/lib/graphic/shape/Sector\");\nexports.Sector = Sector;\nvar Ring = require(\"zrender/lib/graphic/shape/Ring\");\nexports.Ring = Ring;\nvar Polygon = require(\"zrender/lib/graphic/shape/Polygon\");\nexports.Polygon = Polygon;\nvar Polyline = require(\"zrender/lib/graphic/shape/Polyline\");\nexports.Polyline = Polyline;\nvar Rect = require(\"zrender/lib/graphic/shape/Rect\");\nexports.Rect = Rect;\nvar Line = require(\"zrender/lib/graphic/shape/Line\");\nexports.Line = Line;\nvar BezierCurve = require(\"zrender/lib/graphic/shape/BezierCurve\");\nexports.BezierCurve = BezierCurve;\nvar Arc = require(\"zrender/lib/graphic/shape/Arc\");\nexports.Arc = Arc;\nvar CompoundPath = require(\"zrender/lib/graphic/CompoundPath\");\nexports.CompoundPath = CompoundPath;\nvar LinearGradient = require(\"zrender/lib/graphic/LinearGradient\");\nexports.LinearGradient = LinearGradient;\nvar RadialGradient = require(\"zrender/lib/graphic/RadialGradient\");\nexports.RadialGradient = RadialGradient;\nvar BoundingRect = require(\"zrender/lib/core/BoundingRect\");\nexports.BoundingRect = BoundingRect;\nvar IncrementalDisplayable = require(\"zrender/lib/graphic/IncrementalDisplayable\");\nexports.IncrementalDisplayable = IncrementalDisplayable;\nvar subPixelOptimizeUtil = require(\"zrender/lib/graphic/helper/subPixelOptimize\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar mathMax = Math.max;\nvar mathMin = Math.min;\nvar EMPTY_OBJ = {};\nvar Z2_EMPHASIS_LIFT = 1; // key: label model property nane, value: style property name.\n\nvar CACHED_LABEL_STYLE_PROPERTIES = {\n  color: 'textFill',\n  textBorderColor: 'textStroke',\n  textBorderWidth: 'textStrokeWidth'\n};\nvar EMPHASIS = 'emphasis';\nvar NORMAL = 'normal'; // Reserve 0 as default.\n\nvar _highlightNextDigit = 1;\nvar _highlightKeyMap = {};\nvar _customShapeMap = {};\n/**\n * Extend shape with parameters\n */\n\nfunction extendShape(opts) {\n  return Path.extend(opts);\n}\n/**\n * Extend path\n */\n\nfunction extendPath(pathData, opts) {\n  return pathTool.extendFromString(pathData, opts);\n}\n/**\n * Register a user defined shape.\n * The shape class can be fetched by `getShapeClass`\n * This method will overwrite the registered shapes, including\n * the registered built-in shapes, if using the same `name`.\n * The shape can be used in `custom series` and\n * `graphic component` by declaring `{type: name}`.\n *\n * @param {string} name\n * @param {Object} ShapeClass Can be generated by `extendShape`.\n */\n\nfunction registerShape(name, ShapeClass) {\n  _customShapeMap[name] = ShapeClass;\n}\n/**\n * Find shape class registered by `registerShape`. Usually used in\n * fetching user defined shape.\n *\n * [Caution]:\n * (1) This method **MUST NOT be used inside echarts !!!**, unless it is prepared\n * to use user registered shapes.\n * Because the built-in shape (see `getBuiltInShape`) will be registered by\n * `registerShape` by default. That enables users to get both built-in\n * shapes as well as the shapes belonging to themsleves. But users can overwrite\n * the built-in shapes by using names like 'circle', 'rect' via calling\n * `registerShape`. So the echarts inner featrues should not fetch shapes from here\n * in case that it is overwritten by users, except that some features, like\n * `custom series`, `graphic component`, do it deliberately.\n *\n * (2) In the features like `custom series`, `graphic component`, the user input\n * `{tpye: 'xxx'}` does not only specify shapes but also specify other graphic\n * elements like `'group'`, `'text'`, `'image'` or event `'path'`. Those names\n * are reserved names, that is, if some user register a shape named `'image'`,\n * the shape will not be used. If we intending to add some more reserved names\n * in feature, that might bring break changes (disable some existing user shape\n * names). But that case probably rearly happen. So we dont make more mechanism\n * to resolve this issue here.\n *\n * @param {string} name\n * @return {Object} The shape class. If not found, return nothing.\n */\n\nfunction getShapeClass(name) {\n  if (_customShapeMap.hasOwnProperty(name)) {\n    return _customShapeMap[name];\n  }\n}\n/**\n * Create a path element from path data string\n * @param {string} pathData\n * @param {Object} opts\n * @param {module:zrender/core/BoundingRect} rect\n * @param {string} [layout=cover] 'center' or 'cover'\n */\n\nfunction makePath(pathData, opts, rect, layout) {\n  var path = pathTool.createFromString(pathData, opts);\n  if (rect) {\n    if (layout === 'center') {\n      rect = centerGraphic(rect, path.getBoundingRect());\n    }\n    resizePath(path, rect);\n  }\n  return path;\n}\n/**\n * Create a image element from image url\n * @param {string} imageUrl image url\n * @param {Object} opts options\n * @param {module:zrender/core/BoundingRect} rect constrain rect\n * @param {string} [layout=cover] 'center' or 'cover'\n */\n\nfunction makeImage(imageUrl, rect, layout) {\n  var path = new ZImage({\n    style: {\n      image: imageUrl,\n      x: rect.x,\n      y: rect.y,\n      width: rect.width,\n      height: rect.height\n    },\n    onload: function (img) {\n      if (layout === 'center') {\n        var boundingRect = {\n          width: img.width,\n          height: img.height\n        };\n        path.setStyle(centerGraphic(rect, boundingRect));\n      }\n    }\n  });\n  return path;\n}\n/**\n * Get position of centered element in bounding box.\n *\n * @param  {Object} rect         element local bounding box\n * @param  {Object} boundingRect constraint bounding box\n * @return {Object} element position containing x, y, width, and height\n */\n\nfunction centerGraphic(rect, boundingRect) {\n  // Set rect to center, keep width / height ratio.\n  var aspect = boundingRect.width / boundingRect.height;\n  var width = rect.height * aspect;\n  var height;\n  if (width <= rect.width) {\n    height = rect.height;\n  } else {\n    width = rect.width;\n    height = width / aspect;\n  }\n  var cx = rect.x + rect.width / 2;\n  var cy = rect.y + rect.height / 2;\n  return {\n    x: cx - width / 2,\n    y: cy - height / 2,\n    width: width,\n    height: height\n  };\n}\nvar mergePath = pathTool.mergePath;\n/**\n * Resize a path to fit the rect\n * @param {module:zrender/graphic/Path} path\n * @param {Object} rect\n */\n\nfunction resizePath(path, rect) {\n  if (!path.applyTransform) {\n    return;\n  }\n  var pathRect = path.getBoundingRect();\n  var m = pathRect.calculateTransform(rect);\n  path.applyTransform(m);\n}\n/**\n * Sub pixel optimize line for canvas\n *\n * @param {Object} param\n * @param {Object} [param.shape]\n * @param {number} [param.shape.x1]\n * @param {number} [param.shape.y1]\n * @param {number} [param.shape.x2]\n * @param {number} [param.shape.y2]\n * @param {Object} [param.style]\n * @param {number} [param.style.lineWidth]\n * @return {Object} Modified param\n */\n\nfunction subPixelOptimizeLine(param) {\n  subPixelOptimizeUtil.subPixelOptimizeLine(param.shape, param.shape, param.style);\n  return param;\n}\n/**\n * Sub pixel optimize rect for canvas\n *\n * @param {Object} param\n * @param {Object} [param.shape]\n * @param {number} [param.shape.x]\n * @param {number} [param.shape.y]\n * @param {number} [param.shape.width]\n * @param {number} [param.shape.height]\n * @param {Object} [param.style]\n * @param {number} [param.style.lineWidth]\n * @return {Object} Modified param\n */\n\nfunction subPixelOptimizeRect(param) {\n  subPixelOptimizeUtil.subPixelOptimizeRect(param.shape, param.shape, param.style);\n  return param;\n}\n/**\n * Sub pixel optimize for canvas\n *\n * @param {number} position Coordinate, such as x, y\n * @param {number} lineWidth Should be nonnegative integer.\n * @param {boolean=} positiveOrNegative Default false (negative).\n * @return {number} Optimized position.\n */\n\nvar subPixelOptimize = subPixelOptimizeUtil.subPixelOptimize;\nfunction hasFillOrStroke(fillOrStroke) {\n  return fillOrStroke != null && fillOrStroke !== 'none';\n} // Most lifted color are duplicated.\n\nvar liftedColorMap = zrUtil.createHashMap();\nvar liftedColorCount = 0;\nfunction liftColor(color) {\n  if (typeof color !== 'string') {\n    return color;\n  }\n  var liftedColor = liftedColorMap.get(color);\n  if (!liftedColor) {\n    liftedColor = colorTool.lift(color, -0.1);\n    if (liftedColorCount < 10000) {\n      liftedColorMap.set(color, liftedColor);\n      liftedColorCount++;\n    }\n  }\n  return liftedColor;\n}\nfunction cacheElementStl(el) {\n  if (!el.__hoverStlDirty) {\n    return;\n  }\n  el.__hoverStlDirty = false;\n  var hoverStyle = el.__hoverStl;\n  if (!hoverStyle) {\n    el.__cachedNormalStl = el.__cachedNormalZ2 = null;\n    return;\n  }\n  var normalStyle = el.__cachedNormalStl = {};\n  el.__cachedNormalZ2 = el.z2;\n  var elStyle = el.style;\n  for (var name in hoverStyle) {\n    // See comment in `singleEnterEmphasis`.\n    if (hoverStyle[name] != null) {\n      normalStyle[name] = elStyle[name];\n    }\n  } // Always cache fill and stroke to normalStyle for lifting color.\n\n  normalStyle.fill = elStyle.fill;\n  normalStyle.stroke = elStyle.stroke;\n}\nfunction singleEnterEmphasis(el) {\n  var hoverStl = el.__hoverStl;\n  if (!hoverStl || el.__highlighted) {\n    return;\n  }\n  var zr = el.__zr;\n  var useHoverLayer = el.useHoverLayer && zr && zr.painter.type === 'canvas';\n  el.__highlighted = useHoverLayer ? 'layer' : 'plain';\n  if (el.isGroup || !zr && el.useHoverLayer) {\n    return;\n  }\n  var elTarget = el;\n  var targetStyle = el.style;\n  if (useHoverLayer) {\n    elTarget = zr.addHover(el);\n    targetStyle = elTarget.style;\n  }\n  rollbackDefaultTextStyle(targetStyle);\n  if (!useHoverLayer) {\n    cacheElementStl(elTarget);\n  } // styles can be:\n  // {\n  //    label: {\n  //        show: false,\n  //        position: 'outside',\n  //        fontSize: 18\n  //    },\n  //    emphasis: {\n  //        label: {\n  //            show: true\n  //        }\n  //    }\n  // },\n  // where properties of `emphasis` may not appear in `normal`. We previously use\n  // module:echarts/util/model#defaultEmphasis to merge `normal` to `emphasis`.\n  // But consider rich text and setOption in merge mode, it is impossible to cover\n  // all properties in merge. So we use merge mode when setting style here.\n  // But we choose the merge strategy that only properties that is not `null/undefined`.\n  // Because when making a textStyle (espacially rich text), it is not easy to distinguish\n  // `hasOwnProperty` and `null/undefined` in code, so we trade them as the same for simplicity.\n  // But this strategy brings a trouble that `null/undefined` can not be used to remove\n  // style any more in `emphasis`. Users can both set properties directly on normal and\n  // emphasis to avoid this issue, or we might support `'none'` for this case if required.\n\n  targetStyle.extendFrom(hoverStl);\n  setDefaultHoverFillStroke(targetStyle, hoverStl, 'fill');\n  setDefaultHoverFillStroke(targetStyle, hoverStl, 'stroke');\n  applyDefaultTextStyle(targetStyle);\n  if (!useHoverLayer) {\n    el.dirty(false);\n    el.z2 += Z2_EMPHASIS_LIFT;\n  }\n}\nfunction setDefaultHoverFillStroke(targetStyle, hoverStyle, prop) {\n  if (!hasFillOrStroke(hoverStyle[prop]) && hasFillOrStroke(targetStyle[prop])) {\n    targetStyle[prop] = liftColor(targetStyle[prop]);\n  }\n}\nfunction singleEnterNormal(el) {\n  var highlighted = el.__highlighted;\n  if (!highlighted) {\n    return;\n  }\n  el.__highlighted = false;\n  if (el.isGroup) {\n    return;\n  }\n  if (highlighted === 'layer') {\n    el.__zr && el.__zr.removeHover(el);\n  } else {\n    var style = el.style;\n    var normalStl = el.__cachedNormalStl;\n    if (normalStl) {\n      rollbackDefaultTextStyle(style);\n      el.setStyle(normalStl);\n      applyDefaultTextStyle(style);\n    } // `__cachedNormalZ2` will not be reset if calling `setElementHoverStyle`\n    // when `el` is on emphasis state. So here by comparing with 1, we try\n    // hard to make the bug case rare.\n\n    var normalZ2 = el.__cachedNormalZ2;\n    if (normalZ2 != null && el.z2 - normalZ2 === Z2_EMPHASIS_LIFT) {\n      el.z2 = normalZ2;\n    }\n  }\n}\nfunction traverseUpdate(el, updater, commonParam) {\n  // If root is group, also enter updater for `highDownOnUpdate`.\n  var fromState = NORMAL;\n  var toState = NORMAL;\n  var trigger; // See the rule of `highDownOnUpdate` on `graphic.setAsHighDownDispatcher`.\n\n  el.__highlighted && (fromState = EMPHASIS, trigger = true);\n  updater(el, commonParam);\n  el.__highlighted && (toState = EMPHASIS, trigger = true);\n  el.isGroup && el.traverse(function (child) {\n    !child.isGroup && updater(child, commonParam);\n  });\n  trigger && el.__highDownOnUpdate && el.__highDownOnUpdate(fromState, toState);\n}\n/**\n * Set hover style (namely \"emphasis style\") of element, based on the current\n * style of the given `el`.\n * This method should be called after all of the normal styles have been adopted\n * to the `el`. See the reason on `setHoverStyle`.\n *\n * @param {module:zrender/Element} el Should not be `zrender/container/Group`.\n * @param {Object} [el.hoverStyle] Can be set on el or its descendants,\n *        e.g., `el.hoverStyle = ...; graphic.setHoverStyle(el); `.\n *        Often used when item group has a label element and it's hoverStyle is different.\n * @param {Object|boolean} [hoverStl] The specified hover style.\n *        If set as `false`, disable the hover style.\n *        Similarly, The `el.hoverStyle` can alse be set\n *        as `false` to disable the hover style.\n *        Otherwise, use the default hover style if not provided.\n */\n\nfunction setElementHoverStyle(el, hoverStl) {\n  // For performance consideration, it might be better to make the \"hover style\" only the\n  // difference properties from the \"normal style\", but not a entire copy of all styles.\n  hoverStl = el.__hoverStl = hoverStl !== false && (el.hoverStyle || hoverStl || {});\n  el.__hoverStlDirty = true; // FIXME\n  // It is not completely right to save \"normal\"/\"emphasis\" flag on elements.\n  // It probably should be saved on `data` of series. Consider the cases:\n  // (1) A highlighted elements are moved out of the view port and re-enter\n  // again by dataZoom.\n  // (2) call `setOption` and replace elements totally when they are highlighted.\n\n  if (el.__highlighted) {\n    // Consider the case:\n    // The styles of a highlighted `el` is being updated. The new \"emphasis style\"\n    // should be adapted to the `el`. Notice here new \"normal styles\" should have\n    // been set outside and the cached \"normal style\" is out of date.\n    el.__cachedNormalStl = null; // Do not clear `__cachedNormalZ2` here, because setting `z2` is not a constraint\n    // of this method. In most cases, `z2` is not set and hover style should be able\n    // to rollback. Of course, that would bring bug, but only in a rare case, see\n    // `doSingleLeaveHover` for details.\n\n    singleEnterNormal(el);\n    singleEnterEmphasis(el);\n  }\n}\nfunction onElementMouseOver(e) {\n  !shouldSilent(this, e) // \"emphasis\" event highlight has higher priority than mouse highlight.\n  && !this.__highByOuter && traverseUpdate(this, singleEnterEmphasis);\n}\nfunction onElementMouseOut(e) {\n  !shouldSilent(this, e) // \"emphasis\" event highlight has higher priority than mouse highlight.\n  && !this.__highByOuter && traverseUpdate(this, singleEnterNormal);\n}\nfunction onElementEmphasisEvent(highlightDigit) {\n  this.__highByOuter |= 1 << (highlightDigit || 0);\n  traverseUpdate(this, singleEnterEmphasis);\n}\nfunction onElementNormalEvent(highlightDigit) {\n  !(this.__highByOuter &= ~(1 << (highlightDigit || 0))) && traverseUpdate(this, singleEnterNormal);\n}\nfunction shouldSilent(el, e) {\n  return el.__highDownSilentOnTouch && e.zrByTouch;\n}\n/**\n * Set hover style (namely \"emphasis style\") of element,\n * based on the current style of the given `el`.\n *\n * (1)\n * **CONSTRAINTS** for this method:\n * <A> This method MUST be called after all of the normal styles having been adopted\n * to the `el`.\n * <B> The input `hoverStyle` (that is, \"emphasis style\") MUST be the subset of the\n * \"normal style\" having been set to the el.\n * <C> `color` MUST be one of the \"normal styles\" (because color might be lifted as\n * a default hover style).\n *\n * The reason: this method treat the current style of the `el` as the \"normal style\"\n * and cache them when enter/update the \"emphasis style\". Consider the case: the `el`\n * is in \"emphasis\" state and `setOption`/`dispatchAction` trigger the style updating\n * logic, where the el should shift from the original emphasis style to the new\n * \"emphasis style\" and should be able to \"downplay\" back to the new \"normal style\".\n *\n * Indeed, it is error-prone to make a interface has so many constraints, but I have\n * not found a better solution yet to fit the backward compatibility, performance and\n * the current programming style.\n *\n * (2)\n * Call the method for a \"root\" element once. Do not call it for each descendants.\n * If the descendants elemenets of a group has itself hover style different from the\n * root group, we can simply mount the style on `el.hoverStyle` for them, but should\n * not call this method for them.\n *\n * (3) These input parameters can be set directly on `el`:\n *\n * @param {module:zrender/Element} el\n * @param {Object} [el.hoverStyle] See `graphic.setElementHoverStyle`.\n * @param {boolean} [el.highDownSilentOnTouch=false] See `graphic.setAsHighDownDispatcher`.\n * @param {Function} [el.highDownOnUpdate] See `graphic.setAsHighDownDispatcher`.\n * @param {Object|boolean} [hoverStyle] See `graphic.setElementHoverStyle`.\n */\n\nfunction setHoverStyle(el, hoverStyle) {\n  setAsHighDownDispatcher(el, true);\n  traverseUpdate(el, setElementHoverStyle, hoverStyle);\n}\n/**\n * @param {module:zrender/Element} el\n * @param {Function} [el.highDownOnUpdate] Called when state updated.\n *        Since `setHoverStyle` has the constraint that it must be called after\n *        all of the normal style updated, `highDownOnUpdate` is not needed to\n *        trigger if both `fromState` and `toState` is 'normal', and needed to\n *        trigger if both `fromState` and `toState` is 'emphasis', which enables\n *        to sync outside style settings to \"emphasis\" state.\n *        @this {string} This dispatcher `el`.\n *        @param {string} fromState Can be \"normal\" or \"emphasis\".\n *               `fromState` might equal to `toState`,\n *               for example, when this method is called when `el` is\n *               on \"emphasis\" state.\n *        @param {string} toState Can be \"normal\" or \"emphasis\".\n *\n *        FIXME\n *        CAUTION: Do not expose `highDownOnUpdate` outside echarts.\n *        Because it is not a complete solution. The update\n *        listener should not have been mount in element,\n *        and the normal/emphasis state should not have\n *        mantained on elements.\n *\n * @param {boolean} [el.highDownSilentOnTouch=false]\n *        In touch device, mouseover event will be trigger on touchstart event\n *        (see module:zrender/dom/HandlerProxy). By this mechanism, we can\n *        conveniently use hoverStyle when tap on touch screen without additional\n *        code for compatibility.\n *        But if the chart/component has select feature, which usually also use\n *        hoverStyle, there might be conflict between 'select-highlight' and\n *        'hover-highlight' especially when roam is enabled (see geo for example).\n *        In this case, `highDownSilentOnTouch` should be used to disable\n *        hover-highlight on touch device.\n * @param {boolean} [asDispatcher=true] If `false`, do not set as \"highDownDispatcher\".\n */\n\nfunction setAsHighDownDispatcher(el, asDispatcher) {\n  var disable = asDispatcher === false; // Make `highDownSilentOnTouch` and `highDownOnUpdate` only work after\n  // `setAsHighDownDispatcher` called. Avoid it is modified by user unexpectedly.\n\n  el.__highDownSilentOnTouch = el.highDownSilentOnTouch;\n  el.__highDownOnUpdate = el.highDownOnUpdate; // Simple optimize, since this method might be\n  // called for each elements of a group in some cases.\n\n  if (!disable || el.__highDownDispatcher) {\n    var method = disable ? 'off' : 'on'; // Duplicated function will be auto-ignored, see Eventful.js.\n\n    el[method]('mouseover', onElementMouseOver)[method]('mouseout', onElementMouseOut); // Emphasis, normal can be triggered manually by API or other components like hover link.\n\n    el[method]('emphasis', onElementEmphasisEvent)[method]('normal', onElementNormalEvent); // Also keep previous record.\n\n    el.__highByOuter = el.__highByOuter || 0;\n    el.__highDownDispatcher = !disable;\n  }\n}\n/**\n * @param {module:zrender/src/Element} el\n * @return {boolean}\n */\n\nfunction isHighDownDispatcher(el) {\n  return !!(el && el.__highDownDispatcher);\n}\n/**\n * Support hightlight/downplay record on each elements.\n * For the case: hover highlight/downplay (legend, visualMap, ...) and\n * user triggerred hightlight/downplay should not conflict.\n * Only all of the highlightDigit cleared, return to normal.\n * @param {string} highlightKey\n * @return {number} highlightDigit\n */\n\nfunction getHighlightDigit(highlightKey) {\n  var highlightDigit = _highlightKeyMap[highlightKey];\n  if (highlightDigit == null && _highlightNextDigit <= 32) {\n    highlightDigit = _highlightKeyMap[highlightKey] = _highlightNextDigit++;\n  }\n  return highlightDigit;\n}\n/**\n * See more info in `setTextStyleCommon`.\n * @param {Object|module:zrender/graphic/Style} normalStyle\n * @param {Object} emphasisStyle\n * @param {module:echarts/model/Model} normalModel\n * @param {module:echarts/model/Model} emphasisModel\n * @param {Object} opt Check `opt` of `setTextStyleCommon` to find other props.\n * @param {string|Function} [opt.defaultText]\n * @param {module:echarts/model/Model} [opt.labelFetcher] Fetch text by\n *      `opt.labelFetcher.getFormattedLabel(opt.labelDataIndex, 'normal'/'emphasis', null, opt.labelDimIndex, opt.labelProp)`\n * @param {number} [opt.labelDataIndex] Fetch text by\n *      `opt.textFetcher.getFormattedLabel(opt.labelDataIndex, 'normal'/'emphasis', null, opt.labelDimIndex, opt.labelProp)`\n * @param {number} [opt.labelDimIndex] Fetch text by\n *      `opt.textFetcher.getFormattedLabel(opt.labelDataIndex, 'normal'/'emphasis', null, opt.labelDimIndex, opt.labelProp)`\n * @param {string} [opt.labelProp] Fetch text by\n *      `opt.textFetcher.getFormattedLabel(opt.labelDataIndex, 'normal'/'emphasis', null, opt.labelDimIndex, opt.labelProp)`\n * @param {Object} [normalSpecified]\n * @param {Object} [emphasisSpecified]\n */\n\nfunction setLabelStyle(normalStyle, emphasisStyle, normalModel, emphasisModel, opt, normalSpecified, emphasisSpecified) {\n  opt = opt || EMPTY_OBJ;\n  var labelFetcher = opt.labelFetcher;\n  var labelDataIndex = opt.labelDataIndex;\n  var labelDimIndex = opt.labelDimIndex;\n  var labelProp = opt.labelProp; // This scenario, `label.normal.show = true; label.emphasis.show = false`,\n  // is not supported util someone requests.\n\n  var showNormal = normalModel.getShallow('show');\n  var showEmphasis = emphasisModel.getShallow('show'); // Consider performance, only fetch label when necessary.\n  // If `normal.show` is `false` and `emphasis.show` is `true` and `emphasis.formatter` is not set,\n  // label should be displayed, where text is fetched by `normal.formatter` or `opt.defaultText`.\n\n  var baseText;\n  if (showNormal || showEmphasis) {\n    if (labelFetcher) {\n      baseText = labelFetcher.getFormattedLabel(labelDataIndex, 'normal', null, labelDimIndex, labelProp);\n    }\n    if (baseText == null) {\n      baseText = zrUtil.isFunction(opt.defaultText) ? opt.defaultText(labelDataIndex, opt) : opt.defaultText;\n    }\n  }\n  var normalStyleText = showNormal ? baseText : null;\n  var emphasisStyleText = showEmphasis ? zrUtil.retrieve2(labelFetcher ? labelFetcher.getFormattedLabel(labelDataIndex, 'emphasis', null, labelDimIndex, labelProp) : null, baseText) : null; // Optimize: If style.text is null, text will not be drawn.\n\n  if (normalStyleText != null || emphasisStyleText != null) {\n    // Always set `textStyle` even if `normalStyle.text` is null, because default\n    // values have to be set on `normalStyle`.\n    // If we set default values on `emphasisStyle`, consider case:\n    // Firstly, `setOption(... label: {normal: {text: null}, emphasis: {show: true}} ...);`\n    // Secondly, `setOption(... label: {noraml: {show: true, text: 'abc', color: 'red'} ...);`\n    // Then the 'red' will not work on emphasis.\n    setTextStyle(normalStyle, normalModel, normalSpecified, opt);\n    setTextStyle(emphasisStyle, emphasisModel, emphasisSpecified, opt, true);\n  }\n  normalStyle.text = normalStyleText;\n  emphasisStyle.text = emphasisStyleText;\n}\n/**\n * Modify label style manually.\n * Only works after `setLabelStyle` and `setElementHoverStyle` called.\n *\n * @param {module:zrender/src/Element} el\n * @param {Object} [normalStyleProps] optional\n * @param {Object} [emphasisStyleProps] optional\n */\n\nfunction modifyLabelStyle(el, normalStyleProps, emphasisStyleProps) {\n  var elStyle = el.style;\n  if (normalStyleProps) {\n    rollbackDefaultTextStyle(elStyle);\n    el.setStyle(normalStyleProps);\n    applyDefaultTextStyle(elStyle);\n  }\n  elStyle = el.__hoverStl;\n  if (emphasisStyleProps && elStyle) {\n    rollbackDefaultTextStyle(elStyle);\n    zrUtil.extend(elStyle, emphasisStyleProps);\n    applyDefaultTextStyle(elStyle);\n  }\n}\n/**\n * Set basic textStyle properties.\n * See more info in `setTextStyleCommon`.\n * @param {Object|module:zrender/graphic/Style} textStyle\n * @param {module:echarts/model/Model} model\n * @param {Object} [specifiedTextStyle] Can be overrided by settings in model.\n * @param {Object} [opt] See `opt` of `setTextStyleCommon`.\n * @param {boolean} [isEmphasis]\n */\n\nfunction setTextStyle(textStyle, textStyleModel, specifiedTextStyle, opt, isEmphasis) {\n  setTextStyleCommon(textStyle, textStyleModel, opt, isEmphasis);\n  specifiedTextStyle && zrUtil.extend(textStyle, specifiedTextStyle); // textStyle.host && textStyle.host.dirty && textStyle.host.dirty(false);\n\n  return textStyle;\n}\n/**\n * Set text option in the style.\n * See more info in `setTextStyleCommon`.\n * @deprecated\n * @param {Object} textStyle\n * @param {module:echarts/model/Model} labelModel\n * @param {string|boolean} defaultColor Default text color.\n *        If set as false, it will be processed as a emphasis style.\n */\n\nfunction setText(textStyle, labelModel, defaultColor) {\n  var opt = {\n    isRectText: true\n  };\n  var isEmphasis;\n  if (defaultColor === false) {\n    isEmphasis = true;\n  } else {\n    // Support setting color as 'auto' to get visual color.\n    opt.autoColor = defaultColor;\n  }\n  setTextStyleCommon(textStyle, labelModel, opt, isEmphasis); // textStyle.host && textStyle.host.dirty && textStyle.host.dirty(false);\n}\n/**\n * The uniform entry of set text style, that is, retrieve style definitions\n * from `model` and set to `textStyle` object.\n *\n * Never in merge mode, but in overwrite mode, that is, all of the text style\n * properties will be set. (Consider the states of normal and emphasis and\n * default value can be adopted, merge would make the logic too complicated\n * to manage.)\n *\n * The `textStyle` object can either be a plain object or an instance of\n * `zrender/src/graphic/Style`, and either be the style of normal or emphasis.\n * After this mothod called, the `textStyle` object can then be used in\n * `el.setStyle(textStyle)` or `el.hoverStyle = textStyle`.\n *\n * Default value will be adopted and `insideRollbackOpt` will be created.\n * See `applyDefaultTextStyle` `rollbackDefaultTextStyle` for more details.\n *\n * opt: {\n *      disableBox: boolean, Whether diable drawing box of block (outer most).\n *      isRectText: boolean,\n *      autoColor: string, specify a color when color is 'auto',\n *              for textFill, textStroke, textBackgroundColor, and textBorderColor.\n *              If autoColor specified, it is used as default textFill.\n *      useInsideStyle:\n *              `true`: Use inside style (textFill, textStroke, textStrokeWidth)\n *                  if `textFill` is not specified.\n *              `false`: Do not use inside style.\n *              `null/undefined`: use inside style if `isRectText` is true and\n *                  `textFill` is not specified and textPosition contains `'inside'`.\n *      forceRich: boolean\n * }\n */\n\nfunction setTextStyleCommon(textStyle, textStyleModel, opt, isEmphasis) {\n  // Consider there will be abnormal when merge hover style to normal style if given default value.\n  opt = opt || EMPTY_OBJ;\n  if (opt.isRectText) {\n    var textPosition;\n    if (opt.getTextPosition) {\n      textPosition = opt.getTextPosition(textStyleModel, isEmphasis);\n    } else {\n      textPosition = textStyleModel.getShallow('position') || (isEmphasis ? null : 'inside'); // 'outside' is not a valid zr textPostion value, but used\n      // in bar series, and magric type should be considered.\n\n      textPosition === 'outside' && (textPosition = 'top');\n    }\n    textStyle.textPosition = textPosition;\n    textStyle.textOffset = textStyleModel.getShallow('offset');\n    var labelRotate = textStyleModel.getShallow('rotate');\n    labelRotate != null && (labelRotate *= Math.PI / 180);\n    textStyle.textRotation = labelRotate;\n    textStyle.textDistance = zrUtil.retrieve2(textStyleModel.getShallow('distance'), isEmphasis ? null : 5);\n  }\n  var ecModel = textStyleModel.ecModel;\n  var globalTextStyle = ecModel && ecModel.option.textStyle; // Consider case:\n  // {\n  //     data: [{\n  //         value: 12,\n  //         label: {\n  //             rich: {\n  //                 // no 'a' here but using parent 'a'.\n  //             }\n  //         }\n  //     }],\n  //     rich: {\n  //         a: { ... }\n  //     }\n  // }\n\n  var richItemNames = getRichItemNames(textStyleModel);\n  var richResult;\n  if (richItemNames) {\n    richResult = {};\n    for (var name in richItemNames) {\n      if (richItemNames.hasOwnProperty(name)) {\n        // Cascade is supported in rich.\n        var richTextStyle = textStyleModel.getModel(['rich', name]); // In rich, never `disableBox`.\n        // FIXME: consider `label: {formatter: '{a|xx}', color: 'blue', rich: {a: {}}}`,\n        // the default color `'blue'` will not be adopted if no color declared in `rich`.\n        // That might confuses users. So probably we should put `textStyleModel` as the\n        // root ancestor of the `richTextStyle`. But that would be a break change.\n\n        setTokenTextStyle(richResult[name] = {}, richTextStyle, globalTextStyle, opt, isEmphasis);\n      }\n    }\n  }\n  textStyle.rich = richResult;\n  setTokenTextStyle(textStyle, textStyleModel, globalTextStyle, opt, isEmphasis, true);\n  if (opt.forceRich && !opt.textStyle) {\n    opt.textStyle = {};\n  }\n  return textStyle;\n} // Consider case:\n// {\n//     data: [{\n//         value: 12,\n//         label: {\n//             rich: {\n//                 // no 'a' here but using parent 'a'.\n//             }\n//         }\n//     }],\n//     rich: {\n//         a: { ... }\n//     }\n// }\n\nfunction getRichItemNames(textStyleModel) {\n  // Use object to remove duplicated names.\n  var richItemNameMap;\n  while (textStyleModel && textStyleModel !== textStyleModel.ecModel) {\n    var rich = (textStyleModel.option || EMPTY_OBJ).rich;\n    if (rich) {\n      richItemNameMap = richItemNameMap || {};\n      for (var name in rich) {\n        if (rich.hasOwnProperty(name)) {\n          richItemNameMap[name] = 1;\n        }\n      }\n    }\n    textStyleModel = textStyleModel.parentModel;\n  }\n  return richItemNameMap;\n}\nfunction setTokenTextStyle(textStyle, textStyleModel, globalTextStyle, opt, isEmphasis, isBlock) {\n  // In merge mode, default value should not be given.\n  globalTextStyle = !isEmphasis && globalTextStyle || EMPTY_OBJ;\n  textStyle.textFill = getAutoColor(textStyleModel.getShallow('color'), opt) || globalTextStyle.color;\n  textStyle.textStroke = getAutoColor(textStyleModel.getShallow('textBorderColor'), opt) || globalTextStyle.textBorderColor;\n  textStyle.textStrokeWidth = zrUtil.retrieve2(textStyleModel.getShallow('textBorderWidth'), globalTextStyle.textBorderWidth);\n  if (!isEmphasis) {\n    if (isBlock) {\n      textStyle.insideRollbackOpt = opt;\n      applyDefaultTextStyle(textStyle);\n    } // Set default finally.\n\n    if (textStyle.textFill == null) {\n      textStyle.textFill = opt.autoColor;\n    }\n  } // Do not use `getFont` here, because merge should be supported, where\n  // part of these properties may be changed in emphasis style, and the\n  // others should remain their original value got from normal style.\n\n  textStyle.fontStyle = textStyleModel.getShallow('fontStyle') || globalTextStyle.fontStyle;\n  textStyle.fontWeight = textStyleModel.getShallow('fontWeight') || globalTextStyle.fontWeight;\n  textStyle.fontSize = textStyleModel.getShallow('fontSize') || globalTextStyle.fontSize;\n  textStyle.fontFamily = textStyleModel.getShallow('fontFamily') || globalTextStyle.fontFamily;\n  textStyle.textAlign = textStyleModel.getShallow('align');\n  textStyle.textVerticalAlign = textStyleModel.getShallow('verticalAlign') || textStyleModel.getShallow('baseline');\n  textStyle.textLineHeight = textStyleModel.getShallow('lineHeight');\n  textStyle.textWidth = textStyleModel.getShallow('width');\n  textStyle.textHeight = textStyleModel.getShallow('height');\n  textStyle.textTag = textStyleModel.getShallow('tag');\n  if (!isBlock || !opt.disableBox) {\n    textStyle.textBackgroundColor = getAutoColor(textStyleModel.getShallow('backgroundColor'), opt);\n    textStyle.textPadding = textStyleModel.getShallow('padding');\n    textStyle.textBorderColor = getAutoColor(textStyleModel.getShallow('borderColor'), opt);\n    textStyle.textBorderWidth = textStyleModel.getShallow('borderWidth');\n    textStyle.textBorderRadius = textStyleModel.getShallow('borderRadius');\n    textStyle.textBoxShadowColor = textStyleModel.getShallow('shadowColor');\n    textStyle.textBoxShadowBlur = textStyleModel.getShallow('shadowBlur');\n    textStyle.textBoxShadowOffsetX = textStyleModel.getShallow('shadowOffsetX');\n    textStyle.textBoxShadowOffsetY = textStyleModel.getShallow('shadowOffsetY');\n  }\n  textStyle.textShadowColor = textStyleModel.getShallow('textShadowColor') || globalTextStyle.textShadowColor;\n  textStyle.textShadowBlur = textStyleModel.getShallow('textShadowBlur') || globalTextStyle.textShadowBlur;\n  textStyle.textShadowOffsetX = textStyleModel.getShallow('textShadowOffsetX') || globalTextStyle.textShadowOffsetX;\n  textStyle.textShadowOffsetY = textStyleModel.getShallow('textShadowOffsetY') || globalTextStyle.textShadowOffsetY;\n}\nfunction getAutoColor(color, opt) {\n  return color !== 'auto' ? color : opt && opt.autoColor ? opt.autoColor : null;\n}\n/**\n * Give some default value to the input `textStyle` object, based on the current settings\n * in this `textStyle` object.\n *\n * The Scenario:\n * when text position is `inside` and `textFill` is not specified, we show\n * text border by default for better view. But it should be considered that text position\n * might be changed when hovering or being emphasis, where the `insideRollback` is used to\n * restore the style.\n *\n * Usage (& NOTICE):\n * When a style object (eithor plain object or instance of `zrender/src/graphic/Style`) is\n * about to be modified on its text related properties, `rollbackDefaultTextStyle` should\n * be called before the modification and `applyDefaultTextStyle` should be called after that.\n * (For the case that all of the text related properties is reset, like `setTextStyleCommon`\n * does, `rollbackDefaultTextStyle` is not needed to be called).\n */\n\nfunction applyDefaultTextStyle(textStyle) {\n  var textPosition = textStyle.textPosition;\n  var opt = textStyle.insideRollbackOpt;\n  var insideRollback;\n  if (opt && textStyle.textFill == null) {\n    var autoColor = opt.autoColor;\n    var isRectText = opt.isRectText;\n    var useInsideStyle = opt.useInsideStyle;\n    var useInsideStyleCache = useInsideStyle !== false && (useInsideStyle === true || isRectText && textPosition // textPosition can be [10, 30]\n    && typeof textPosition === 'string' && textPosition.indexOf('inside') >= 0);\n    var useAutoColorCache = !useInsideStyleCache && autoColor != null; // All of the props declared in `CACHED_LABEL_STYLE_PROPERTIES` are to be cached.\n\n    if (useInsideStyleCache || useAutoColorCache) {\n      insideRollback = {\n        textFill: textStyle.textFill,\n        textStroke: textStyle.textStroke,\n        textStrokeWidth: textStyle.textStrokeWidth\n      };\n    }\n    if (useInsideStyleCache) {\n      textStyle.textFill = '#fff'; // Consider text with #fff overflow its container.\n\n      if (textStyle.textStroke == null) {\n        textStyle.textStroke = autoColor;\n        textStyle.textStrokeWidth == null && (textStyle.textStrokeWidth = 2);\n      }\n    }\n    if (useAutoColorCache) {\n      textStyle.textFill = autoColor;\n    }\n  } // Always set `insideRollback`, so that the previous one can be cleared.\n\n  textStyle.insideRollback = insideRollback;\n}\n/**\n * Consider the case: in a scatter,\n * label: {\n *     normal: {position: 'inside'},\n *     emphasis: {position: 'top'}\n * }\n * In the normal state, the `textFill` will be set as '#fff' for pretty view (see\n * `applyDefaultTextStyle`), but when switching to emphasis state, the `textFill`\n * should be retured to 'autoColor', but not keep '#fff'.\n */\n\nfunction rollbackDefaultTextStyle(style) {\n  var insideRollback = style.insideRollback;\n  if (insideRollback) {\n    // Reset all of the props in `CACHED_LABEL_STYLE_PROPERTIES`.\n    style.textFill = insideRollback.textFill;\n    style.textStroke = insideRollback.textStroke;\n    style.textStrokeWidth = insideRollback.textStrokeWidth;\n    style.insideRollback = null;\n  }\n}\nfunction getFont(opt, ecModel) {\n  var gTextStyleModel = ecModel && ecModel.getModel('textStyle');\n  return zrUtil.trim([\n  // FIXME in node-canvas fontWeight is before fontStyle\n  opt.fontStyle || gTextStyleModel && gTextStyleModel.getShallow('fontStyle') || '', opt.fontWeight || gTextStyleModel && gTextStyleModel.getShallow('fontWeight') || '', (opt.fontSize || gTextStyleModel && gTextStyleModel.getShallow('fontSize') || 12) + 'px', opt.fontFamily || gTextStyleModel && gTextStyleModel.getShallow('fontFamily') || 'sans-serif'].join(' '));\n}\nfunction animateOrSetProps(isUpdate, el, props, animatableModel, dataIndex, cb) {\n  if (typeof dataIndex === 'function') {\n    cb = dataIndex;\n    dataIndex = null;\n  } // Do not check 'animation' property directly here. Consider this case:\n  // animation model is an `itemModel`, whose does not have `isAnimationEnabled`\n  // but its parent model (`seriesModel`) does.\n\n  var animationEnabled = animatableModel && animatableModel.isAnimationEnabled();\n  if (animationEnabled) {\n    var postfix = isUpdate ? 'Update' : '';\n    var duration = animatableModel.getShallow('animationDuration' + postfix);\n    var animationEasing = animatableModel.getShallow('animationEasing' + postfix);\n    var animationDelay = animatableModel.getShallow('animationDelay' + postfix);\n    if (typeof animationDelay === 'function') {\n      animationDelay = animationDelay(dataIndex, animatableModel.getAnimationDelayParams ? animatableModel.getAnimationDelayParams(el, dataIndex) : null);\n    }\n    if (typeof duration === 'function') {\n      duration = duration(dataIndex);\n    }\n    duration > 0 ? el.animateTo(props, duration, animationDelay || 0, animationEasing, cb, !!cb) : (el.stopAnimation(), el.attr(props), cb && cb());\n  } else {\n    el.stopAnimation();\n    el.attr(props);\n    cb && cb();\n  }\n}\n/**\n * Update graphic element properties with or without animation according to the\n * configuration in series.\n *\n * Caution: this method will stop previous animation.\n * So do not use this method to one element twice before\n * animation starts, unless you know what you are doing.\n *\n * @param {module:zrender/Element} el\n * @param {Object} props\n * @param {module:echarts/model/Model} [animatableModel]\n * @param {number} [dataIndex]\n * @param {Function} [cb]\n * @example\n *     graphic.updateProps(el, {\n *         position: [100, 100]\n *     }, seriesModel, dataIndex, function () { console.log('Animation done!'); });\n *     // Or\n *     graphic.updateProps(el, {\n *         position: [100, 100]\n *     }, seriesModel, function () { console.log('Animation done!'); });\n */\n\nfunction updateProps(el, props, animatableModel, dataIndex, cb) {\n  animateOrSetProps(true, el, props, animatableModel, dataIndex, cb);\n}\n/**\n * Init graphic element properties with or without animation according to the\n * configuration in series.\n *\n * Caution: this method will stop previous animation.\n * So do not use this method to one element twice before\n * animation starts, unless you know what you are doing.\n *\n * @param {module:zrender/Element} el\n * @param {Object} props\n * @param {module:echarts/model/Model} [animatableModel]\n * @param {number} [dataIndex]\n * @param {Function} cb\n */\n\nfunction initProps(el, props, animatableModel, dataIndex, cb) {\n  animateOrSetProps(false, el, props, animatableModel, dataIndex, cb);\n}\n/**\n * Get transform matrix of target (param target),\n * in coordinate of its ancestor (param ancestor)\n *\n * @param {module:zrender/mixin/Transformable} target\n * @param {module:zrender/mixin/Transformable} [ancestor]\n */\n\nfunction getTransform(target, ancestor) {\n  var mat = matrix.identity([]);\n  while (target && target !== ancestor) {\n    matrix.mul(mat, target.getLocalTransform(), mat);\n    target = target.parent;\n  }\n  return mat;\n}\n/**\n * Apply transform to an vertex.\n * @param {Array.<number>} target [x, y]\n * @param {Array.<number>|TypedArray.<number>|Object} transform Can be:\n *      + Transform matrix: like [1, 0, 0, 1, 0, 0]\n *      + {position, rotation, scale}, the same as `zrender/Transformable`.\n * @param {boolean=} invert Whether use invert matrix.\n * @return {Array.<number>} [x, y]\n */\n\nfunction applyTransform(target, transform, invert) {\n  if (transform && !zrUtil.isArrayLike(transform)) {\n    transform = Transformable.getLocalTransform(transform);\n  }\n  if (invert) {\n    transform = matrix.invert([], transform);\n  }\n  return vector.applyTransform([], target, transform);\n}\n/**\n * @param {string} direction 'left' 'right' 'top' 'bottom'\n * @param {Array.<number>} transform Transform matrix: like [1, 0, 0, 1, 0, 0]\n * @param {boolean=} invert Whether use invert matrix.\n * @return {string} Transformed direction. 'left' 'right' 'top' 'bottom'\n */\n\nfunction transformDirection(direction, transform, invert) {\n  // Pick a base, ensure that transform result will not be (0, 0).\n  var hBase = transform[4] === 0 || transform[5] === 0 || transform[0] === 0 ? 1 : Math.abs(2 * transform[4] / transform[0]);\n  var vBase = transform[4] === 0 || transform[5] === 0 || transform[2] === 0 ? 1 : Math.abs(2 * transform[4] / transform[2]);\n  var vertex = [direction === 'left' ? -hBase : direction === 'right' ? hBase : 0, direction === 'top' ? -vBase : direction === 'bottom' ? vBase : 0];\n  vertex = applyTransform(vertex, transform, invert);\n  return Math.abs(vertex[0]) > Math.abs(vertex[1]) ? vertex[0] > 0 ? 'right' : 'left' : vertex[1] > 0 ? 'bottom' : 'top';\n}\n/**\n * Apply group transition animation from g1 to g2.\n * If no animatableModel, no animation.\n */\n\nfunction groupTransition(g1, g2, animatableModel, cb) {\n  if (!g1 || !g2) {\n    return;\n  }\n  function getElMap(g) {\n    var elMap = {};\n    g.traverse(function (el) {\n      if (!el.isGroup && el.anid) {\n        elMap[el.anid] = el;\n      }\n    });\n    return elMap;\n  }\n  function getAnimatableProps(el) {\n    var obj = {\n      position: vector.clone(el.position),\n      rotation: el.rotation\n    };\n    if (el.shape) {\n      obj.shape = zrUtil.extend({}, el.shape);\n    }\n    return obj;\n  }\n  var elMap1 = getElMap(g1);\n  g2.traverse(function (el) {\n    if (!el.isGroup && el.anid) {\n      var oldEl = elMap1[el.anid];\n      if (oldEl) {\n        var newProp = getAnimatableProps(el);\n        el.attr(getAnimatableProps(oldEl));\n        updateProps(el, newProp, animatableModel, el.dataIndex);\n      } // else {\n      //     if (el.previousProps) {\n      //         graphic.updateProps\n      //     }\n      // }\n    }\n  });\n}\n/**\n * @param {Array.<Array.<number>>} points Like: [[23, 44], [53, 66], ...]\n * @param {Object} rect {x, y, width, height}\n * @return {Array.<Array.<number>>} A new clipped points.\n */\n\nfunction clipPointsByRect(points, rect) {\n  // FIXME: this way migth be incorrect when grpahic clipped by a corner.\n  // and when element have border.\n  return zrUtil.map(points, function (point) {\n    var x = point[0];\n    x = mathMax(x, rect.x);\n    x = mathMin(x, rect.x + rect.width);\n    var y = point[1];\n    y = mathMax(y, rect.y);\n    y = mathMin(y, rect.y + rect.height);\n    return [x, y];\n  });\n}\n/**\n * @param {Object} targetRect {x, y, width, height}\n * @param {Object} rect {x, y, width, height}\n * @return {Object} A new clipped rect. If rect size are negative, return undefined.\n */\n\nfunction clipRectByRect(targetRect, rect) {\n  var x = mathMax(targetRect.x, rect.x);\n  var x2 = mathMin(targetRect.x + targetRect.width, rect.x + rect.width);\n  var y = mathMax(targetRect.y, rect.y);\n  var y2 = mathMin(targetRect.y + targetRect.height, rect.y + rect.height); // If the total rect is cliped, nothing, including the border,\n  // should be painted. So return undefined.\n\n  if (x2 >= x && y2 >= y) {\n    return {\n      x: x,\n      y: y,\n      width: x2 - x,\n      height: y2 - y\n    };\n  }\n}\n/**\n * @param {string} iconStr Support 'image://' or 'path://' or direct svg path.\n * @param {Object} [opt] Properties of `module:zrender/Element`, except `style`.\n * @param {Object} [rect] {x, y, width, height}\n * @return {module:zrender/Element} Icon path or image element.\n */\n\nfunction createIcon(iconStr, opt, rect) {\n  opt = zrUtil.extend({\n    rectHover: true\n  }, opt);\n  var style = opt.style = {\n    strokeNoScale: true\n  };\n  rect = rect || {\n    x: -1,\n    y: -1,\n    width: 2,\n    height: 2\n  };\n  if (iconStr) {\n    return iconStr.indexOf('image://') === 0 ? (style.image = iconStr.slice(8), zrUtil.defaults(style, rect), new ZImage(opt)) : makePath(iconStr.replace('path://', ''), opt, rect, 'center');\n  }\n}\n/**\n * Return `true` if the given line (line `a`) and the given polygon\n * are intersect.\n * Note that we do not count colinear as intersect here because no\n * requirement for that. We could do that if required in future.\n *\n * @param {number} a1x\n * @param {number} a1y\n * @param {number} a2x\n * @param {number} a2y\n * @param {Array.<Array.<number>>} points Points of the polygon.\n * @return {boolean}\n */\n\nfunction linePolygonIntersect(a1x, a1y, a2x, a2y, points) {\n  for (var i = 0, p2 = points[points.length - 1]; i < points.length; i++) {\n    var p = points[i];\n    if (lineLineIntersect(a1x, a1y, a2x, a2y, p[0], p[1], p2[0], p2[1])) {\n      return true;\n    }\n    p2 = p;\n  }\n}\n/**\n * Return `true` if the given two lines (line `a` and line `b`)\n * are intersect.\n * Note that we do not count colinear as intersect here because no\n * requirement for that. We could do that if required in future.\n *\n * @param {number} a1x\n * @param {number} a1y\n * @param {number} a2x\n * @param {number} a2y\n * @param {number} b1x\n * @param {number} b1y\n * @param {number} b2x\n * @param {number} b2y\n * @return {boolean}\n */\n\nfunction lineLineIntersect(a1x, a1y, a2x, a2y, b1x, b1y, b2x, b2y) {\n  // let `vec_m` to be `vec_a2 - vec_a1` and `vec_n` to be `vec_b2 - vec_b1`.\n  var mx = a2x - a1x;\n  var my = a2y - a1y;\n  var nx = b2x - b1x;\n  var ny = b2y - b1y; // `vec_m` and `vec_n` are parallel iff\n  //     exising `k` such that `vec_m = k  vec_n`, equivalent to `vec_m X vec_n = 0`.\n\n  var nmCrossProduct = crossProduct2d(nx, ny, mx, my);\n  if (nearZero(nmCrossProduct)) {\n    return false;\n  } // `vec_m` and `vec_n` are intersect iff\n  //     existing `p` and `q` in [0, 1] such that `vec_a1 + p * vec_m = vec_b1 + q * vec_n`,\n  //     such that `q = ((vec_a1 - vec_b1) X vec_m) / (vec_n X vec_m)`\n  //           and `p = ((vec_a1 - vec_b1) X vec_n) / (vec_n X vec_m)`.\n\n  var b1a1x = a1x - b1x;\n  var b1a1y = a1y - b1y;\n  var q = crossProduct2d(b1a1x, b1a1y, mx, my) / nmCrossProduct;\n  if (q < 0 || q > 1) {\n    return false;\n  }\n  var p = crossProduct2d(b1a1x, b1a1y, nx, ny) / nmCrossProduct;\n  if (p < 0 || p > 1) {\n    return false;\n  }\n  return true;\n}\n/**\n * Cross product of 2-dimension vector.\n */\n\nfunction crossProduct2d(x1, y1, x2, y2) {\n  return x1 * y2 - x2 * y1;\n}\nfunction nearZero(val) {\n  return val <= 1e-6 && val >= -1e-6;\n} // Register built-in shapes. These shapes might be overwirtten\n// by users, although we do not recommend that.\n\nregisterShape('circle', Circle);\nregisterShape('sector', Sector);\nregisterShape('ring', Ring);\nregisterShape('polygon', Polygon);\nregisterShape('polyline', Polyline);\nregisterShape('rect', Rect);\nregisterShape('line', Line);\nregisterShape('bezierCurve', BezierCurve);\nregisterShape('arc', Arc);\nexports.Z2_EMPHASIS_LIFT = Z2_EMPHASIS_LIFT;\nexports.CACHED_LABEL_STYLE_PROPERTIES = CACHED_LABEL_STYLE_PROPERTIES;\nexports.extendShape = extendShape;\nexports.extendPath = extendPath;\nexports.registerShape = registerShape;\nexports.getShapeClass = getShapeClass;\nexports.makePath = makePath;\nexports.makeImage = makeImage;\nexports.mergePath = mergePath;\nexports.resizePath = resizePath;\nexports.subPixelOptimizeLine = subPixelOptimizeLine;\nexports.subPixelOptimizeRect = subPixelOptimizeRect;\nexports.subPixelOptimize = subPixelOptimize;\nexports.setElementHoverStyle = setElementHoverStyle;\nexports.setHoverStyle = setHoverStyle;\nexports.setAsHighDownDispatcher = setAsHighDownDispatcher;\nexports.isHighDownDispatcher = isHighDownDispatcher;\nexports.getHighlightDigit = getHighlightDigit;\nexports.setLabelStyle = setLabelStyle;\nexports.modifyLabelStyle = modifyLabelStyle;\nexports.setTextStyle = setTextStyle;\nexports.setText = setText;\nexports.getFont = getFont;\nexports.updateProps = updateProps;\nexports.initProps = initProps;\nexports.getTransform = getTransform;\nexports.applyTransform = applyTransform;\nexports.transformDirection = transformDirection;\nexports.groupTransition = groupTransition;\nexports.clipPointsByRect = clipPointsByRect;\nexports.clipRectByRect = clipRectByRect;\nexports.createIcon = createIcon;\nexports.linePolygonIntersect = linePolygonIntersect;\nexports.lineLineIntersect = lineLineIntersect;","map":{"version":3,"names":["zrUtil","require","pathTool","colorTool","matrix","vector","Path","Transformable","ZImage","exports","Image","Group","Text","Circle","Sector","Ring","Polygon","Polyline","Rect","Line","BezierCurve","Arc","CompoundPath","LinearGradient","RadialGradient","BoundingRect","IncrementalDisplayable","subPixelOptimizeUtil","mathMax","Math","max","mathMin","min","EMPTY_OBJ","Z2_EMPHASIS_LIFT","CACHED_LABEL_STYLE_PROPERTIES","color","textBorderColor","textBorderWidth","EMPHASIS","NORMAL","_highlightNextDigit","_highlightKeyMap","_customShapeMap","extendShape","opts","extend","extendPath","pathData","extendFromString","registerShape","name","ShapeClass","getShapeClass","hasOwnProperty","makePath","rect","layout","path","createFromString","centerGraphic","getBoundingRect","resizePath","makeImage","imageUrl","style","image","x","y","width","height","onload","img","boundingRect","setStyle","aspect","cx","cy","mergePath","applyTransform","pathRect","m","calculateTransform","subPixelOptimizeLine","param","shape","subPixelOptimizeRect","subPixelOptimize","hasFillOrStroke","fillOrStroke","liftedColorMap","createHashMap","liftedColorCount","liftColor","liftedColor","get","lift","set","cacheElementStl","el","__hoverStlDirty","hoverStyle","__hoverStl","__cachedNormalStl","__cachedNormalZ2","normalStyle","z2","elStyle","fill","stroke","singleEnterEmphasis","hoverStl","__highlighted","zr","__zr","useHoverLayer","painter","type","isGroup","elTarget","targetStyle","addHover","rollbackDefaultTextStyle","extendFrom","setDefaultHoverFillStroke","applyDefaultTextStyle","dirty","prop","singleEnterNormal","highlighted","removeHover","normalStl","normalZ2","traverseUpdate","updater","commonParam","fromState","toState","trigger","traverse","child","__highDownOnUpdate","setElementHoverStyle","onElementMouseOver","e","shouldSilent","__highByOuter","onElementMouseOut","onElementEmphasisEvent","highlightDigit","onElementNormalEvent","__highDownSilentOnTouch","zrByTouch","setHoverStyle","setAsHighDownDispatcher","asDispatcher","disable","highDownSilentOnTouch","highDownOnUpdate","__highDownDispatcher","method","isHighDownDispatcher","getHighlightDigit","highlightKey","setLabelStyle","emphasisStyle","normalModel","emphasisModel","opt","normalSpecified","emphasisSpecified","labelFetcher","labelDataIndex","labelDimIndex","labelProp","showNormal","getShallow","showEmphasis","baseText","getFormattedLabel","isFunction","defaultText","normalStyleText","emphasisStyleText","retrieve2","setTextStyle","text","modifyLabelStyle","normalStyleProps","emphasisStyleProps","textStyle","textStyleModel","specifiedTextStyle","isEmphasis","setTextStyleCommon","setText","labelModel","defaultColor","isRectText","autoColor","textPosition","getTextPosition","textOffset","labelRotate","PI","textRotation","textDistance","ecModel","globalTextStyle","option","richItemNames","getRichItemNames","richResult","richTextStyle","getModel","setTokenTextStyle","rich","forceRich","richItemNameMap","parentModel","isBlock","textFill","getAutoColor","textStroke","textStrokeWidth","insideRollbackOpt","fontStyle","fontWeight","fontSize","fontFamily","textAlign","textVerticalAlign","textLineHeight","textWidth","textHeight","textTag","disableBox","textBackgroundColor","textPadding","textBorderRadius","textBoxShadowColor","textBoxShadowBlur","textBoxShadowOffsetX","textBoxShadowOffsetY","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY","insideRollback","useInsideStyle","useInsideStyleCache","indexOf","useAutoColorCache","getFont","gTextStyleModel","trim","join","animateOrSetProps","isUpdate","props","animatableModel","dataIndex","cb","animationEnabled","isAnimationEnabled","postfix","duration","animationEasing","animationDelay","getAnimationDelayParams","animateTo","stopAnimation","attr","updateProps","initProps","getTransform","target","ancestor","mat","identity","mul","getLocalTransform","parent","transform","invert","isArrayLike","transformDirection","direction","hBase","abs","vBase","vertex","groupTransition","g1","g2","getElMap","g","elMap","anid","getAnimatableProps","obj","position","clone","rotation","elMap1","oldEl","newProp","clipPointsByRect","points","map","point","clipRectByRect","targetRect","x2","y2","createIcon","iconStr","rectHover","strokeNoScale","slice","defaults","replace","linePolygonIntersect","a1x","a1y","a2x","a2y","i","p2","length","p","lineLineIntersect","b1x","b1y","b2x","b2y","mx","my","nx","ny","nmCrossProduct","crossProduct2d","nearZero","b1a1x","b1a1y","q","x1","y1","val"],"sources":["/Users/zoyazhou/workspace/vscodeProjects/ccc_assign2/node_modules/echarts/lib/util/graphic.js"],"sourcesContent":["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar pathTool = require(\"zrender/lib/tool/path\");\n\nvar colorTool = require(\"zrender/lib/tool/color\");\n\nvar matrix = require(\"zrender/lib/core/matrix\");\n\nvar vector = require(\"zrender/lib/core/vector\");\n\nvar Path = require(\"zrender/lib/graphic/Path\");\n\nvar Transformable = require(\"zrender/lib/mixin/Transformable\");\n\nvar ZImage = require(\"zrender/lib/graphic/Image\");\n\nexports.Image = ZImage;\n\nvar Group = require(\"zrender/lib/container/Group\");\n\nexports.Group = Group;\n\nvar Text = require(\"zrender/lib/graphic/Text\");\n\nexports.Text = Text;\n\nvar Circle = require(\"zrender/lib/graphic/shape/Circle\");\n\nexports.Circle = Circle;\n\nvar Sector = require(\"zrender/lib/graphic/shape/Sector\");\n\nexports.Sector = Sector;\n\nvar Ring = require(\"zrender/lib/graphic/shape/Ring\");\n\nexports.Ring = Ring;\n\nvar Polygon = require(\"zrender/lib/graphic/shape/Polygon\");\n\nexports.Polygon = Polygon;\n\nvar Polyline = require(\"zrender/lib/graphic/shape/Polyline\");\n\nexports.Polyline = Polyline;\n\nvar Rect = require(\"zrender/lib/graphic/shape/Rect\");\n\nexports.Rect = Rect;\n\nvar Line = require(\"zrender/lib/graphic/shape/Line\");\n\nexports.Line = Line;\n\nvar BezierCurve = require(\"zrender/lib/graphic/shape/BezierCurve\");\n\nexports.BezierCurve = BezierCurve;\n\nvar Arc = require(\"zrender/lib/graphic/shape/Arc\");\n\nexports.Arc = Arc;\n\nvar CompoundPath = require(\"zrender/lib/graphic/CompoundPath\");\n\nexports.CompoundPath = CompoundPath;\n\nvar LinearGradient = require(\"zrender/lib/graphic/LinearGradient\");\n\nexports.LinearGradient = LinearGradient;\n\nvar RadialGradient = require(\"zrender/lib/graphic/RadialGradient\");\n\nexports.RadialGradient = RadialGradient;\n\nvar BoundingRect = require(\"zrender/lib/core/BoundingRect\");\n\nexports.BoundingRect = BoundingRect;\n\nvar IncrementalDisplayable = require(\"zrender/lib/graphic/IncrementalDisplayable\");\n\nexports.IncrementalDisplayable = IncrementalDisplayable;\n\nvar subPixelOptimizeUtil = require(\"zrender/lib/graphic/helper/subPixelOptimize\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar mathMax = Math.max;\nvar mathMin = Math.min;\nvar EMPTY_OBJ = {};\nvar Z2_EMPHASIS_LIFT = 1; // key: label model property nane, value: style property name.\n\nvar CACHED_LABEL_STYLE_PROPERTIES = {\n  color: 'textFill',\n  textBorderColor: 'textStroke',\n  textBorderWidth: 'textStrokeWidth'\n};\nvar EMPHASIS = 'emphasis';\nvar NORMAL = 'normal'; // Reserve 0 as default.\n\nvar _highlightNextDigit = 1;\nvar _highlightKeyMap = {};\nvar _customShapeMap = {};\n/**\n * Extend shape with parameters\n */\n\nfunction extendShape(opts) {\n  return Path.extend(opts);\n}\n/**\n * Extend path\n */\n\n\nfunction extendPath(pathData, opts) {\n  return pathTool.extendFromString(pathData, opts);\n}\n/**\n * Register a user defined shape.\n * The shape class can be fetched by `getShapeClass`\n * This method will overwrite the registered shapes, including\n * the registered built-in shapes, if using the same `name`.\n * The shape can be used in `custom series` and\n * `graphic component` by declaring `{type: name}`.\n *\n * @param {string} name\n * @param {Object} ShapeClass Can be generated by `extendShape`.\n */\n\n\nfunction registerShape(name, ShapeClass) {\n  _customShapeMap[name] = ShapeClass;\n}\n/**\n * Find shape class registered by `registerShape`. Usually used in\n * fetching user defined shape.\n *\n * [Caution]:\n * (1) This method **MUST NOT be used inside echarts !!!**, unless it is prepared\n * to use user registered shapes.\n * Because the built-in shape (see `getBuiltInShape`) will be registered by\n * `registerShape` by default. That enables users to get both built-in\n * shapes as well as the shapes belonging to themsleves. But users can overwrite\n * the built-in shapes by using names like 'circle', 'rect' via calling\n * `registerShape`. So the echarts inner featrues should not fetch shapes from here\n * in case that it is overwritten by users, except that some features, like\n * `custom series`, `graphic component`, do it deliberately.\n *\n * (2) In the features like `custom series`, `graphic component`, the user input\n * `{tpye: 'xxx'}` does not only specify shapes but also specify other graphic\n * elements like `'group'`, `'text'`, `'image'` or event `'path'`. Those names\n * are reserved names, that is, if some user register a shape named `'image'`,\n * the shape will not be used. If we intending to add some more reserved names\n * in feature, that might bring break changes (disable some existing user shape\n * names). But that case probably rearly happen. So we dont make more mechanism\n * to resolve this issue here.\n *\n * @param {string} name\n * @return {Object} The shape class. If not found, return nothing.\n */\n\n\nfunction getShapeClass(name) {\n  if (_customShapeMap.hasOwnProperty(name)) {\n    return _customShapeMap[name];\n  }\n}\n/**\n * Create a path element from path data string\n * @param {string} pathData\n * @param {Object} opts\n * @param {module:zrender/core/BoundingRect} rect\n * @param {string} [layout=cover] 'center' or 'cover'\n */\n\n\nfunction makePath(pathData, opts, rect, layout) {\n  var path = pathTool.createFromString(pathData, opts);\n\n  if (rect) {\n    if (layout === 'center') {\n      rect = centerGraphic(rect, path.getBoundingRect());\n    }\n\n    resizePath(path, rect);\n  }\n\n  return path;\n}\n/**\n * Create a image element from image url\n * @param {string} imageUrl image url\n * @param {Object} opts options\n * @param {module:zrender/core/BoundingRect} rect constrain rect\n * @param {string} [layout=cover] 'center' or 'cover'\n */\n\n\nfunction makeImage(imageUrl, rect, layout) {\n  var path = new ZImage({\n    style: {\n      image: imageUrl,\n      x: rect.x,\n      y: rect.y,\n      width: rect.width,\n      height: rect.height\n    },\n    onload: function (img) {\n      if (layout === 'center') {\n        var boundingRect = {\n          width: img.width,\n          height: img.height\n        };\n        path.setStyle(centerGraphic(rect, boundingRect));\n      }\n    }\n  });\n  return path;\n}\n/**\n * Get position of centered element in bounding box.\n *\n * @param  {Object} rect         element local bounding box\n * @param  {Object} boundingRect constraint bounding box\n * @return {Object} element position containing x, y, width, and height\n */\n\n\nfunction centerGraphic(rect, boundingRect) {\n  // Set rect to center, keep width / height ratio.\n  var aspect = boundingRect.width / boundingRect.height;\n  var width = rect.height * aspect;\n  var height;\n\n  if (width <= rect.width) {\n    height = rect.height;\n  } else {\n    width = rect.width;\n    height = width / aspect;\n  }\n\n  var cx = rect.x + rect.width / 2;\n  var cy = rect.y + rect.height / 2;\n  return {\n    x: cx - width / 2,\n    y: cy - height / 2,\n    width: width,\n    height: height\n  };\n}\n\nvar mergePath = pathTool.mergePath;\n/**\n * Resize a path to fit the rect\n * @param {module:zrender/graphic/Path} path\n * @param {Object} rect\n */\n\nfunction resizePath(path, rect) {\n  if (!path.applyTransform) {\n    return;\n  }\n\n  var pathRect = path.getBoundingRect();\n  var m = pathRect.calculateTransform(rect);\n  path.applyTransform(m);\n}\n/**\n * Sub pixel optimize line for canvas\n *\n * @param {Object} param\n * @param {Object} [param.shape]\n * @param {number} [param.shape.x1]\n * @param {number} [param.shape.y1]\n * @param {number} [param.shape.x2]\n * @param {number} [param.shape.y2]\n * @param {Object} [param.style]\n * @param {number} [param.style.lineWidth]\n * @return {Object} Modified param\n */\n\n\nfunction subPixelOptimizeLine(param) {\n  subPixelOptimizeUtil.subPixelOptimizeLine(param.shape, param.shape, param.style);\n  return param;\n}\n/**\n * Sub pixel optimize rect for canvas\n *\n * @param {Object} param\n * @param {Object} [param.shape]\n * @param {number} [param.shape.x]\n * @param {number} [param.shape.y]\n * @param {number} [param.shape.width]\n * @param {number} [param.shape.height]\n * @param {Object} [param.style]\n * @param {number} [param.style.lineWidth]\n * @return {Object} Modified param\n */\n\n\nfunction subPixelOptimizeRect(param) {\n  subPixelOptimizeUtil.subPixelOptimizeRect(param.shape, param.shape, param.style);\n  return param;\n}\n/**\n * Sub pixel optimize for canvas\n *\n * @param {number} position Coordinate, such as x, y\n * @param {number} lineWidth Should be nonnegative integer.\n * @param {boolean=} positiveOrNegative Default false (negative).\n * @return {number} Optimized position.\n */\n\n\nvar subPixelOptimize = subPixelOptimizeUtil.subPixelOptimize;\n\nfunction hasFillOrStroke(fillOrStroke) {\n  return fillOrStroke != null && fillOrStroke !== 'none';\n} // Most lifted color are duplicated.\n\n\nvar liftedColorMap = zrUtil.createHashMap();\nvar liftedColorCount = 0;\n\nfunction liftColor(color) {\n  if (typeof color !== 'string') {\n    return color;\n  }\n\n  var liftedColor = liftedColorMap.get(color);\n\n  if (!liftedColor) {\n    liftedColor = colorTool.lift(color, -0.1);\n\n    if (liftedColorCount < 10000) {\n      liftedColorMap.set(color, liftedColor);\n      liftedColorCount++;\n    }\n  }\n\n  return liftedColor;\n}\n\nfunction cacheElementStl(el) {\n  if (!el.__hoverStlDirty) {\n    return;\n  }\n\n  el.__hoverStlDirty = false;\n  var hoverStyle = el.__hoverStl;\n\n  if (!hoverStyle) {\n    el.__cachedNormalStl = el.__cachedNormalZ2 = null;\n    return;\n  }\n\n  var normalStyle = el.__cachedNormalStl = {};\n  el.__cachedNormalZ2 = el.z2;\n  var elStyle = el.style;\n\n  for (var name in hoverStyle) {\n    // See comment in `singleEnterEmphasis`.\n    if (hoverStyle[name] != null) {\n      normalStyle[name] = elStyle[name];\n    }\n  } // Always cache fill and stroke to normalStyle for lifting color.\n\n\n  normalStyle.fill = elStyle.fill;\n  normalStyle.stroke = elStyle.stroke;\n}\n\nfunction singleEnterEmphasis(el) {\n  var hoverStl = el.__hoverStl;\n\n  if (!hoverStl || el.__highlighted) {\n    return;\n  }\n\n  var zr = el.__zr;\n  var useHoverLayer = el.useHoverLayer && zr && zr.painter.type === 'canvas';\n  el.__highlighted = useHoverLayer ? 'layer' : 'plain';\n\n  if (el.isGroup || !zr && el.useHoverLayer) {\n    return;\n  }\n\n  var elTarget = el;\n  var targetStyle = el.style;\n\n  if (useHoverLayer) {\n    elTarget = zr.addHover(el);\n    targetStyle = elTarget.style;\n  }\n\n  rollbackDefaultTextStyle(targetStyle);\n\n  if (!useHoverLayer) {\n    cacheElementStl(elTarget);\n  } // styles can be:\n  // {\n  //    label: {\n  //        show: false,\n  //        position: 'outside',\n  //        fontSize: 18\n  //    },\n  //    emphasis: {\n  //        label: {\n  //            show: true\n  //        }\n  //    }\n  // },\n  // where properties of `emphasis` may not appear in `normal`. We previously use\n  // module:echarts/util/model#defaultEmphasis to merge `normal` to `emphasis`.\n  // But consider rich text and setOption in merge mode, it is impossible to cover\n  // all properties in merge. So we use merge mode when setting style here.\n  // But we choose the merge strategy that only properties that is not `null/undefined`.\n  // Because when making a textStyle (espacially rich text), it is not easy to distinguish\n  // `hasOwnProperty` and `null/undefined` in code, so we trade them as the same for simplicity.\n  // But this strategy brings a trouble that `null/undefined` can not be used to remove\n  // style any more in `emphasis`. Users can both set properties directly on normal and\n  // emphasis to avoid this issue, or we might support `'none'` for this case if required.\n\n\n  targetStyle.extendFrom(hoverStl);\n  setDefaultHoverFillStroke(targetStyle, hoverStl, 'fill');\n  setDefaultHoverFillStroke(targetStyle, hoverStl, 'stroke');\n  applyDefaultTextStyle(targetStyle);\n\n  if (!useHoverLayer) {\n    el.dirty(false);\n    el.z2 += Z2_EMPHASIS_LIFT;\n  }\n}\n\nfunction setDefaultHoverFillStroke(targetStyle, hoverStyle, prop) {\n  if (!hasFillOrStroke(hoverStyle[prop]) && hasFillOrStroke(targetStyle[prop])) {\n    targetStyle[prop] = liftColor(targetStyle[prop]);\n  }\n}\n\nfunction singleEnterNormal(el) {\n  var highlighted = el.__highlighted;\n\n  if (!highlighted) {\n    return;\n  }\n\n  el.__highlighted = false;\n\n  if (el.isGroup) {\n    return;\n  }\n\n  if (highlighted === 'layer') {\n    el.__zr && el.__zr.removeHover(el);\n  } else {\n    var style = el.style;\n    var normalStl = el.__cachedNormalStl;\n\n    if (normalStl) {\n      rollbackDefaultTextStyle(style);\n      el.setStyle(normalStl);\n      applyDefaultTextStyle(style);\n    } // `__cachedNormalZ2` will not be reset if calling `setElementHoverStyle`\n    // when `el` is on emphasis state. So here by comparing with 1, we try\n    // hard to make the bug case rare.\n\n\n    var normalZ2 = el.__cachedNormalZ2;\n\n    if (normalZ2 != null && el.z2 - normalZ2 === Z2_EMPHASIS_LIFT) {\n      el.z2 = normalZ2;\n    }\n  }\n}\n\nfunction traverseUpdate(el, updater, commonParam) {\n  // If root is group, also enter updater for `highDownOnUpdate`.\n  var fromState = NORMAL;\n  var toState = NORMAL;\n  var trigger; // See the rule of `highDownOnUpdate` on `graphic.setAsHighDownDispatcher`.\n\n  el.__highlighted && (fromState = EMPHASIS, trigger = true);\n  updater(el, commonParam);\n  el.__highlighted && (toState = EMPHASIS, trigger = true);\n  el.isGroup && el.traverse(function (child) {\n    !child.isGroup && updater(child, commonParam);\n  });\n  trigger && el.__highDownOnUpdate && el.__highDownOnUpdate(fromState, toState);\n}\n/**\n * Set hover style (namely \"emphasis style\") of element, based on the current\n * style of the given `el`.\n * This method should be called after all of the normal styles have been adopted\n * to the `el`. See the reason on `setHoverStyle`.\n *\n * @param {module:zrender/Element} el Should not be `zrender/container/Group`.\n * @param {Object} [el.hoverStyle] Can be set on el or its descendants,\n *        e.g., `el.hoverStyle = ...; graphic.setHoverStyle(el); `.\n *        Often used when item group has a label element and it's hoverStyle is different.\n * @param {Object|boolean} [hoverStl] The specified hover style.\n *        If set as `false`, disable the hover style.\n *        Similarly, The `el.hoverStyle` can alse be set\n *        as `false` to disable the hover style.\n *        Otherwise, use the default hover style if not provided.\n */\n\n\nfunction setElementHoverStyle(el, hoverStl) {\n  // For performance consideration, it might be better to make the \"hover style\" only the\n  // difference properties from the \"normal style\", but not a entire copy of all styles.\n  hoverStl = el.__hoverStl = hoverStl !== false && (el.hoverStyle || hoverStl || {});\n  el.__hoverStlDirty = true; // FIXME\n  // It is not completely right to save \"normal\"/\"emphasis\" flag on elements.\n  // It probably should be saved on `data` of series. Consider the cases:\n  // (1) A highlighted elements are moved out of the view port and re-enter\n  // again by dataZoom.\n  // (2) call `setOption` and replace elements totally when they are highlighted.\n\n  if (el.__highlighted) {\n    // Consider the case:\n    // The styles of a highlighted `el` is being updated. The new \"emphasis style\"\n    // should be adapted to the `el`. Notice here new \"normal styles\" should have\n    // been set outside and the cached \"normal style\" is out of date.\n    el.__cachedNormalStl = null; // Do not clear `__cachedNormalZ2` here, because setting `z2` is not a constraint\n    // of this method. In most cases, `z2` is not set and hover style should be able\n    // to rollback. Of course, that would bring bug, but only in a rare case, see\n    // `doSingleLeaveHover` for details.\n\n    singleEnterNormal(el);\n    singleEnterEmphasis(el);\n  }\n}\n\nfunction onElementMouseOver(e) {\n  !shouldSilent(this, e) // \"emphasis\" event highlight has higher priority than mouse highlight.\n  && !this.__highByOuter && traverseUpdate(this, singleEnterEmphasis);\n}\n\nfunction onElementMouseOut(e) {\n  !shouldSilent(this, e) // \"emphasis\" event highlight has higher priority than mouse highlight.\n  && !this.__highByOuter && traverseUpdate(this, singleEnterNormal);\n}\n\nfunction onElementEmphasisEvent(highlightDigit) {\n  this.__highByOuter |= 1 << (highlightDigit || 0);\n  traverseUpdate(this, singleEnterEmphasis);\n}\n\nfunction onElementNormalEvent(highlightDigit) {\n  !(this.__highByOuter &= ~(1 << (highlightDigit || 0))) && traverseUpdate(this, singleEnterNormal);\n}\n\nfunction shouldSilent(el, e) {\n  return el.__highDownSilentOnTouch && e.zrByTouch;\n}\n/**\n * Set hover style (namely \"emphasis style\") of element,\n * based on the current style of the given `el`.\n *\n * (1)\n * **CONSTRAINTS** for this method:\n * <A> This method MUST be called after all of the normal styles having been adopted\n * to the `el`.\n * <B> The input `hoverStyle` (that is, \"emphasis style\") MUST be the subset of the\n * \"normal style\" having been set to the el.\n * <C> `color` MUST be one of the \"normal styles\" (because color might be lifted as\n * a default hover style).\n *\n * The reason: this method treat the current style of the `el` as the \"normal style\"\n * and cache them when enter/update the \"emphasis style\". Consider the case: the `el`\n * is in \"emphasis\" state and `setOption`/`dispatchAction` trigger the style updating\n * logic, where the el should shift from the original emphasis style to the new\n * \"emphasis style\" and should be able to \"downplay\" back to the new \"normal style\".\n *\n * Indeed, it is error-prone to make a interface has so many constraints, but I have\n * not found a better solution yet to fit the backward compatibility, performance and\n * the current programming style.\n *\n * (2)\n * Call the method for a \"root\" element once. Do not call it for each descendants.\n * If the descendants elemenets of a group has itself hover style different from the\n * root group, we can simply mount the style on `el.hoverStyle` for them, but should\n * not call this method for them.\n *\n * (3) These input parameters can be set directly on `el`:\n *\n * @param {module:zrender/Element} el\n * @param {Object} [el.hoverStyle] See `graphic.setElementHoverStyle`.\n * @param {boolean} [el.highDownSilentOnTouch=false] See `graphic.setAsHighDownDispatcher`.\n * @param {Function} [el.highDownOnUpdate] See `graphic.setAsHighDownDispatcher`.\n * @param {Object|boolean} [hoverStyle] See `graphic.setElementHoverStyle`.\n */\n\n\nfunction setHoverStyle(el, hoverStyle) {\n  setAsHighDownDispatcher(el, true);\n  traverseUpdate(el, setElementHoverStyle, hoverStyle);\n}\n/**\n * @param {module:zrender/Element} el\n * @param {Function} [el.highDownOnUpdate] Called when state updated.\n *        Since `setHoverStyle` has the constraint that it must be called after\n *        all of the normal style updated, `highDownOnUpdate` is not needed to\n *        trigger if both `fromState` and `toState` is 'normal', and needed to\n *        trigger if both `fromState` and `toState` is 'emphasis', which enables\n *        to sync outside style settings to \"emphasis\" state.\n *        @this {string} This dispatcher `el`.\n *        @param {string} fromState Can be \"normal\" or \"emphasis\".\n *               `fromState` might equal to `toState`,\n *               for example, when this method is called when `el` is\n *               on \"emphasis\" state.\n *        @param {string} toState Can be \"normal\" or \"emphasis\".\n *\n *        FIXME\n *        CAUTION: Do not expose `highDownOnUpdate` outside echarts.\n *        Because it is not a complete solution. The update\n *        listener should not have been mount in element,\n *        and the normal/emphasis state should not have\n *        mantained on elements.\n *\n * @param {boolean} [el.highDownSilentOnTouch=false]\n *        In touch device, mouseover event will be trigger on touchstart event\n *        (see module:zrender/dom/HandlerProxy). By this mechanism, we can\n *        conveniently use hoverStyle when tap on touch screen without additional\n *        code for compatibility.\n *        But if the chart/component has select feature, which usually also use\n *        hoverStyle, there might be conflict between 'select-highlight' and\n *        'hover-highlight' especially when roam is enabled (see geo for example).\n *        In this case, `highDownSilentOnTouch` should be used to disable\n *        hover-highlight on touch device.\n * @param {boolean} [asDispatcher=true] If `false`, do not set as \"highDownDispatcher\".\n */\n\n\nfunction setAsHighDownDispatcher(el, asDispatcher) {\n  var disable = asDispatcher === false; // Make `highDownSilentOnTouch` and `highDownOnUpdate` only work after\n  // `setAsHighDownDispatcher` called. Avoid it is modified by user unexpectedly.\n\n  el.__highDownSilentOnTouch = el.highDownSilentOnTouch;\n  el.__highDownOnUpdate = el.highDownOnUpdate; // Simple optimize, since this method might be\n  // called for each elements of a group in some cases.\n\n  if (!disable || el.__highDownDispatcher) {\n    var method = disable ? 'off' : 'on'; // Duplicated function will be auto-ignored, see Eventful.js.\n\n    el[method]('mouseover', onElementMouseOver)[method]('mouseout', onElementMouseOut); // Emphasis, normal can be triggered manually by API or other components like hover link.\n\n    el[method]('emphasis', onElementEmphasisEvent)[method]('normal', onElementNormalEvent); // Also keep previous record.\n\n    el.__highByOuter = el.__highByOuter || 0;\n    el.__highDownDispatcher = !disable;\n  }\n}\n/**\n * @param {module:zrender/src/Element} el\n * @return {boolean}\n */\n\n\nfunction isHighDownDispatcher(el) {\n  return !!(el && el.__highDownDispatcher);\n}\n/**\n * Support hightlight/downplay record on each elements.\n * For the case: hover highlight/downplay (legend, visualMap, ...) and\n * user triggerred hightlight/downplay should not conflict.\n * Only all of the highlightDigit cleared, return to normal.\n * @param {string} highlightKey\n * @return {number} highlightDigit\n */\n\n\nfunction getHighlightDigit(highlightKey) {\n  var highlightDigit = _highlightKeyMap[highlightKey];\n\n  if (highlightDigit == null && _highlightNextDigit <= 32) {\n    highlightDigit = _highlightKeyMap[highlightKey] = _highlightNextDigit++;\n  }\n\n  return highlightDigit;\n}\n/**\n * See more info in `setTextStyleCommon`.\n * @param {Object|module:zrender/graphic/Style} normalStyle\n * @param {Object} emphasisStyle\n * @param {module:echarts/model/Model} normalModel\n * @param {module:echarts/model/Model} emphasisModel\n * @param {Object} opt Check `opt` of `setTextStyleCommon` to find other props.\n * @param {string|Function} [opt.defaultText]\n * @param {module:echarts/model/Model} [opt.labelFetcher] Fetch text by\n *      `opt.labelFetcher.getFormattedLabel(opt.labelDataIndex, 'normal'/'emphasis', null, opt.labelDimIndex, opt.labelProp)`\n * @param {number} [opt.labelDataIndex] Fetch text by\n *      `opt.textFetcher.getFormattedLabel(opt.labelDataIndex, 'normal'/'emphasis', null, opt.labelDimIndex, opt.labelProp)`\n * @param {number} [opt.labelDimIndex] Fetch text by\n *      `opt.textFetcher.getFormattedLabel(opt.labelDataIndex, 'normal'/'emphasis', null, opt.labelDimIndex, opt.labelProp)`\n * @param {string} [opt.labelProp] Fetch text by\n *      `opt.textFetcher.getFormattedLabel(opt.labelDataIndex, 'normal'/'emphasis', null, opt.labelDimIndex, opt.labelProp)`\n * @param {Object} [normalSpecified]\n * @param {Object} [emphasisSpecified]\n */\n\n\nfunction setLabelStyle(normalStyle, emphasisStyle, normalModel, emphasisModel, opt, normalSpecified, emphasisSpecified) {\n  opt = opt || EMPTY_OBJ;\n  var labelFetcher = opt.labelFetcher;\n  var labelDataIndex = opt.labelDataIndex;\n  var labelDimIndex = opt.labelDimIndex;\n  var labelProp = opt.labelProp; // This scenario, `label.normal.show = true; label.emphasis.show = false`,\n  // is not supported util someone requests.\n\n  var showNormal = normalModel.getShallow('show');\n  var showEmphasis = emphasisModel.getShallow('show'); // Consider performance, only fetch label when necessary.\n  // If `normal.show` is `false` and `emphasis.show` is `true` and `emphasis.formatter` is not set,\n  // label should be displayed, where text is fetched by `normal.formatter` or `opt.defaultText`.\n\n  var baseText;\n\n  if (showNormal || showEmphasis) {\n    if (labelFetcher) {\n      baseText = labelFetcher.getFormattedLabel(labelDataIndex, 'normal', null, labelDimIndex, labelProp);\n    }\n\n    if (baseText == null) {\n      baseText = zrUtil.isFunction(opt.defaultText) ? opt.defaultText(labelDataIndex, opt) : opt.defaultText;\n    }\n  }\n\n  var normalStyleText = showNormal ? baseText : null;\n  var emphasisStyleText = showEmphasis ? zrUtil.retrieve2(labelFetcher ? labelFetcher.getFormattedLabel(labelDataIndex, 'emphasis', null, labelDimIndex, labelProp) : null, baseText) : null; // Optimize: If style.text is null, text will not be drawn.\n\n  if (normalStyleText != null || emphasisStyleText != null) {\n    // Always set `textStyle` even if `normalStyle.text` is null, because default\n    // values have to be set on `normalStyle`.\n    // If we set default values on `emphasisStyle`, consider case:\n    // Firstly, `setOption(... label: {normal: {text: null}, emphasis: {show: true}} ...);`\n    // Secondly, `setOption(... label: {noraml: {show: true, text: 'abc', color: 'red'} ...);`\n    // Then the 'red' will not work on emphasis.\n    setTextStyle(normalStyle, normalModel, normalSpecified, opt);\n    setTextStyle(emphasisStyle, emphasisModel, emphasisSpecified, opt, true);\n  }\n\n  normalStyle.text = normalStyleText;\n  emphasisStyle.text = emphasisStyleText;\n}\n/**\n * Modify label style manually.\n * Only works after `setLabelStyle` and `setElementHoverStyle` called.\n *\n * @param {module:zrender/src/Element} el\n * @param {Object} [normalStyleProps] optional\n * @param {Object} [emphasisStyleProps] optional\n */\n\n\nfunction modifyLabelStyle(el, normalStyleProps, emphasisStyleProps) {\n  var elStyle = el.style;\n\n  if (normalStyleProps) {\n    rollbackDefaultTextStyle(elStyle);\n    el.setStyle(normalStyleProps);\n    applyDefaultTextStyle(elStyle);\n  }\n\n  elStyle = el.__hoverStl;\n\n  if (emphasisStyleProps && elStyle) {\n    rollbackDefaultTextStyle(elStyle);\n    zrUtil.extend(elStyle, emphasisStyleProps);\n    applyDefaultTextStyle(elStyle);\n  }\n}\n/**\n * Set basic textStyle properties.\n * See more info in `setTextStyleCommon`.\n * @param {Object|module:zrender/graphic/Style} textStyle\n * @param {module:echarts/model/Model} model\n * @param {Object} [specifiedTextStyle] Can be overrided by settings in model.\n * @param {Object} [opt] See `opt` of `setTextStyleCommon`.\n * @param {boolean} [isEmphasis]\n */\n\n\nfunction setTextStyle(textStyle, textStyleModel, specifiedTextStyle, opt, isEmphasis) {\n  setTextStyleCommon(textStyle, textStyleModel, opt, isEmphasis);\n  specifiedTextStyle && zrUtil.extend(textStyle, specifiedTextStyle); // textStyle.host && textStyle.host.dirty && textStyle.host.dirty(false);\n\n  return textStyle;\n}\n/**\n * Set text option in the style.\n * See more info in `setTextStyleCommon`.\n * @deprecated\n * @param {Object} textStyle\n * @param {module:echarts/model/Model} labelModel\n * @param {string|boolean} defaultColor Default text color.\n *        If set as false, it will be processed as a emphasis style.\n */\n\n\nfunction setText(textStyle, labelModel, defaultColor) {\n  var opt = {\n    isRectText: true\n  };\n  var isEmphasis;\n\n  if (defaultColor === false) {\n    isEmphasis = true;\n  } else {\n    // Support setting color as 'auto' to get visual color.\n    opt.autoColor = defaultColor;\n  }\n\n  setTextStyleCommon(textStyle, labelModel, opt, isEmphasis); // textStyle.host && textStyle.host.dirty && textStyle.host.dirty(false);\n}\n/**\n * The uniform entry of set text style, that is, retrieve style definitions\n * from `model` and set to `textStyle` object.\n *\n * Never in merge mode, but in overwrite mode, that is, all of the text style\n * properties will be set. (Consider the states of normal and emphasis and\n * default value can be adopted, merge would make the logic too complicated\n * to manage.)\n *\n * The `textStyle` object can either be a plain object or an instance of\n * `zrender/src/graphic/Style`, and either be the style of normal or emphasis.\n * After this mothod called, the `textStyle` object can then be used in\n * `el.setStyle(textStyle)` or `el.hoverStyle = textStyle`.\n *\n * Default value will be adopted and `insideRollbackOpt` will be created.\n * See `applyDefaultTextStyle` `rollbackDefaultTextStyle` for more details.\n *\n * opt: {\n *      disableBox: boolean, Whether diable drawing box of block (outer most).\n *      isRectText: boolean,\n *      autoColor: string, specify a color when color is 'auto',\n *              for textFill, textStroke, textBackgroundColor, and textBorderColor.\n *              If autoColor specified, it is used as default textFill.\n *      useInsideStyle:\n *              `true`: Use inside style (textFill, textStroke, textStrokeWidth)\n *                  if `textFill` is not specified.\n *              `false`: Do not use inside style.\n *              `null/undefined`: use inside style if `isRectText` is true and\n *                  `textFill` is not specified and textPosition contains `'inside'`.\n *      forceRich: boolean\n * }\n */\n\n\nfunction setTextStyleCommon(textStyle, textStyleModel, opt, isEmphasis) {\n  // Consider there will be abnormal when merge hover style to normal style if given default value.\n  opt = opt || EMPTY_OBJ;\n\n  if (opt.isRectText) {\n    var textPosition;\n\n    if (opt.getTextPosition) {\n      textPosition = opt.getTextPosition(textStyleModel, isEmphasis);\n    } else {\n      textPosition = textStyleModel.getShallow('position') || (isEmphasis ? null : 'inside'); // 'outside' is not a valid zr textPostion value, but used\n      // in bar series, and magric type should be considered.\n\n      textPosition === 'outside' && (textPosition = 'top');\n    }\n\n    textStyle.textPosition = textPosition;\n    textStyle.textOffset = textStyleModel.getShallow('offset');\n    var labelRotate = textStyleModel.getShallow('rotate');\n    labelRotate != null && (labelRotate *= Math.PI / 180);\n    textStyle.textRotation = labelRotate;\n    textStyle.textDistance = zrUtil.retrieve2(textStyleModel.getShallow('distance'), isEmphasis ? null : 5);\n  }\n\n  var ecModel = textStyleModel.ecModel;\n  var globalTextStyle = ecModel && ecModel.option.textStyle; // Consider case:\n  // {\n  //     data: [{\n  //         value: 12,\n  //         label: {\n  //             rich: {\n  //                 // no 'a' here but using parent 'a'.\n  //             }\n  //         }\n  //     }],\n  //     rich: {\n  //         a: { ... }\n  //     }\n  // }\n\n  var richItemNames = getRichItemNames(textStyleModel);\n  var richResult;\n\n  if (richItemNames) {\n    richResult = {};\n\n    for (var name in richItemNames) {\n      if (richItemNames.hasOwnProperty(name)) {\n        // Cascade is supported in rich.\n        var richTextStyle = textStyleModel.getModel(['rich', name]); // In rich, never `disableBox`.\n        // FIXME: consider `label: {formatter: '{a|xx}', color: 'blue', rich: {a: {}}}`,\n        // the default color `'blue'` will not be adopted if no color declared in `rich`.\n        // That might confuses users. So probably we should put `textStyleModel` as the\n        // root ancestor of the `richTextStyle`. But that would be a break change.\n\n        setTokenTextStyle(richResult[name] = {}, richTextStyle, globalTextStyle, opt, isEmphasis);\n      }\n    }\n  }\n\n  textStyle.rich = richResult;\n  setTokenTextStyle(textStyle, textStyleModel, globalTextStyle, opt, isEmphasis, true);\n\n  if (opt.forceRich && !opt.textStyle) {\n    opt.textStyle = {};\n  }\n\n  return textStyle;\n} // Consider case:\n// {\n//     data: [{\n//         value: 12,\n//         label: {\n//             rich: {\n//                 // no 'a' here but using parent 'a'.\n//             }\n//         }\n//     }],\n//     rich: {\n//         a: { ... }\n//     }\n// }\n\n\nfunction getRichItemNames(textStyleModel) {\n  // Use object to remove duplicated names.\n  var richItemNameMap;\n\n  while (textStyleModel && textStyleModel !== textStyleModel.ecModel) {\n    var rich = (textStyleModel.option || EMPTY_OBJ).rich;\n\n    if (rich) {\n      richItemNameMap = richItemNameMap || {};\n\n      for (var name in rich) {\n        if (rich.hasOwnProperty(name)) {\n          richItemNameMap[name] = 1;\n        }\n      }\n    }\n\n    textStyleModel = textStyleModel.parentModel;\n  }\n\n  return richItemNameMap;\n}\n\nfunction setTokenTextStyle(textStyle, textStyleModel, globalTextStyle, opt, isEmphasis, isBlock) {\n  // In merge mode, default value should not be given.\n  globalTextStyle = !isEmphasis && globalTextStyle || EMPTY_OBJ;\n  textStyle.textFill = getAutoColor(textStyleModel.getShallow('color'), opt) || globalTextStyle.color;\n  textStyle.textStroke = getAutoColor(textStyleModel.getShallow('textBorderColor'), opt) || globalTextStyle.textBorderColor;\n  textStyle.textStrokeWidth = zrUtil.retrieve2(textStyleModel.getShallow('textBorderWidth'), globalTextStyle.textBorderWidth);\n\n  if (!isEmphasis) {\n    if (isBlock) {\n      textStyle.insideRollbackOpt = opt;\n      applyDefaultTextStyle(textStyle);\n    } // Set default finally.\n\n\n    if (textStyle.textFill == null) {\n      textStyle.textFill = opt.autoColor;\n    }\n  } // Do not use `getFont` here, because merge should be supported, where\n  // part of these properties may be changed in emphasis style, and the\n  // others should remain their original value got from normal style.\n\n\n  textStyle.fontStyle = textStyleModel.getShallow('fontStyle') || globalTextStyle.fontStyle;\n  textStyle.fontWeight = textStyleModel.getShallow('fontWeight') || globalTextStyle.fontWeight;\n  textStyle.fontSize = textStyleModel.getShallow('fontSize') || globalTextStyle.fontSize;\n  textStyle.fontFamily = textStyleModel.getShallow('fontFamily') || globalTextStyle.fontFamily;\n  textStyle.textAlign = textStyleModel.getShallow('align');\n  textStyle.textVerticalAlign = textStyleModel.getShallow('verticalAlign') || textStyleModel.getShallow('baseline');\n  textStyle.textLineHeight = textStyleModel.getShallow('lineHeight');\n  textStyle.textWidth = textStyleModel.getShallow('width');\n  textStyle.textHeight = textStyleModel.getShallow('height');\n  textStyle.textTag = textStyleModel.getShallow('tag');\n\n  if (!isBlock || !opt.disableBox) {\n    textStyle.textBackgroundColor = getAutoColor(textStyleModel.getShallow('backgroundColor'), opt);\n    textStyle.textPadding = textStyleModel.getShallow('padding');\n    textStyle.textBorderColor = getAutoColor(textStyleModel.getShallow('borderColor'), opt);\n    textStyle.textBorderWidth = textStyleModel.getShallow('borderWidth');\n    textStyle.textBorderRadius = textStyleModel.getShallow('borderRadius');\n    textStyle.textBoxShadowColor = textStyleModel.getShallow('shadowColor');\n    textStyle.textBoxShadowBlur = textStyleModel.getShallow('shadowBlur');\n    textStyle.textBoxShadowOffsetX = textStyleModel.getShallow('shadowOffsetX');\n    textStyle.textBoxShadowOffsetY = textStyleModel.getShallow('shadowOffsetY');\n  }\n\n  textStyle.textShadowColor = textStyleModel.getShallow('textShadowColor') || globalTextStyle.textShadowColor;\n  textStyle.textShadowBlur = textStyleModel.getShallow('textShadowBlur') || globalTextStyle.textShadowBlur;\n  textStyle.textShadowOffsetX = textStyleModel.getShallow('textShadowOffsetX') || globalTextStyle.textShadowOffsetX;\n  textStyle.textShadowOffsetY = textStyleModel.getShallow('textShadowOffsetY') || globalTextStyle.textShadowOffsetY;\n}\n\nfunction getAutoColor(color, opt) {\n  return color !== 'auto' ? color : opt && opt.autoColor ? opt.autoColor : null;\n}\n/**\n * Give some default value to the input `textStyle` object, based on the current settings\n * in this `textStyle` object.\n *\n * The Scenario:\n * when text position is `inside` and `textFill` is not specified, we show\n * text border by default for better view. But it should be considered that text position\n * might be changed when hovering or being emphasis, where the `insideRollback` is used to\n * restore the style.\n *\n * Usage (& NOTICE):\n * When a style object (eithor plain object or instance of `zrender/src/graphic/Style`) is\n * about to be modified on its text related properties, `rollbackDefaultTextStyle` should\n * be called before the modification and `applyDefaultTextStyle` should be called after that.\n * (For the case that all of the text related properties is reset, like `setTextStyleCommon`\n * does, `rollbackDefaultTextStyle` is not needed to be called).\n */\n\n\nfunction applyDefaultTextStyle(textStyle) {\n  var textPosition = textStyle.textPosition;\n  var opt = textStyle.insideRollbackOpt;\n  var insideRollback;\n\n  if (opt && textStyle.textFill == null) {\n    var autoColor = opt.autoColor;\n    var isRectText = opt.isRectText;\n    var useInsideStyle = opt.useInsideStyle;\n    var useInsideStyleCache = useInsideStyle !== false && (useInsideStyle === true || isRectText && textPosition // textPosition can be [10, 30]\n    && typeof textPosition === 'string' && textPosition.indexOf('inside') >= 0);\n    var useAutoColorCache = !useInsideStyleCache && autoColor != null; // All of the props declared in `CACHED_LABEL_STYLE_PROPERTIES` are to be cached.\n\n    if (useInsideStyleCache || useAutoColorCache) {\n      insideRollback = {\n        textFill: textStyle.textFill,\n        textStroke: textStyle.textStroke,\n        textStrokeWidth: textStyle.textStrokeWidth\n      };\n    }\n\n    if (useInsideStyleCache) {\n      textStyle.textFill = '#fff'; // Consider text with #fff overflow its container.\n\n      if (textStyle.textStroke == null) {\n        textStyle.textStroke = autoColor;\n        textStyle.textStrokeWidth == null && (textStyle.textStrokeWidth = 2);\n      }\n    }\n\n    if (useAutoColorCache) {\n      textStyle.textFill = autoColor;\n    }\n  } // Always set `insideRollback`, so that the previous one can be cleared.\n\n\n  textStyle.insideRollback = insideRollback;\n}\n/**\n * Consider the case: in a scatter,\n * label: {\n *     normal: {position: 'inside'},\n *     emphasis: {position: 'top'}\n * }\n * In the normal state, the `textFill` will be set as '#fff' for pretty view (see\n * `applyDefaultTextStyle`), but when switching to emphasis state, the `textFill`\n * should be retured to 'autoColor', but not keep '#fff'.\n */\n\n\nfunction rollbackDefaultTextStyle(style) {\n  var insideRollback = style.insideRollback;\n\n  if (insideRollback) {\n    // Reset all of the props in `CACHED_LABEL_STYLE_PROPERTIES`.\n    style.textFill = insideRollback.textFill;\n    style.textStroke = insideRollback.textStroke;\n    style.textStrokeWidth = insideRollback.textStrokeWidth;\n    style.insideRollback = null;\n  }\n}\n\nfunction getFont(opt, ecModel) {\n  var gTextStyleModel = ecModel && ecModel.getModel('textStyle');\n  return zrUtil.trim([// FIXME in node-canvas fontWeight is before fontStyle\n  opt.fontStyle || gTextStyleModel && gTextStyleModel.getShallow('fontStyle') || '', opt.fontWeight || gTextStyleModel && gTextStyleModel.getShallow('fontWeight') || '', (opt.fontSize || gTextStyleModel && gTextStyleModel.getShallow('fontSize') || 12) + 'px', opt.fontFamily || gTextStyleModel && gTextStyleModel.getShallow('fontFamily') || 'sans-serif'].join(' '));\n}\n\nfunction animateOrSetProps(isUpdate, el, props, animatableModel, dataIndex, cb) {\n  if (typeof dataIndex === 'function') {\n    cb = dataIndex;\n    dataIndex = null;\n  } // Do not check 'animation' property directly here. Consider this case:\n  // animation model is an `itemModel`, whose does not have `isAnimationEnabled`\n  // but its parent model (`seriesModel`) does.\n\n\n  var animationEnabled = animatableModel && animatableModel.isAnimationEnabled();\n\n  if (animationEnabled) {\n    var postfix = isUpdate ? 'Update' : '';\n    var duration = animatableModel.getShallow('animationDuration' + postfix);\n    var animationEasing = animatableModel.getShallow('animationEasing' + postfix);\n    var animationDelay = animatableModel.getShallow('animationDelay' + postfix);\n\n    if (typeof animationDelay === 'function') {\n      animationDelay = animationDelay(dataIndex, animatableModel.getAnimationDelayParams ? animatableModel.getAnimationDelayParams(el, dataIndex) : null);\n    }\n\n    if (typeof duration === 'function') {\n      duration = duration(dataIndex);\n    }\n\n    duration > 0 ? el.animateTo(props, duration, animationDelay || 0, animationEasing, cb, !!cb) : (el.stopAnimation(), el.attr(props), cb && cb());\n  } else {\n    el.stopAnimation();\n    el.attr(props);\n    cb && cb();\n  }\n}\n/**\n * Update graphic element properties with or without animation according to the\n * configuration in series.\n *\n * Caution: this method will stop previous animation.\n * So do not use this method to one element twice before\n * animation starts, unless you know what you are doing.\n *\n * @param {module:zrender/Element} el\n * @param {Object} props\n * @param {module:echarts/model/Model} [animatableModel]\n * @param {number} [dataIndex]\n * @param {Function} [cb]\n * @example\n *     graphic.updateProps(el, {\n *         position: [100, 100]\n *     }, seriesModel, dataIndex, function () { console.log('Animation done!'); });\n *     // Or\n *     graphic.updateProps(el, {\n *         position: [100, 100]\n *     }, seriesModel, function () { console.log('Animation done!'); });\n */\n\n\nfunction updateProps(el, props, animatableModel, dataIndex, cb) {\n  animateOrSetProps(true, el, props, animatableModel, dataIndex, cb);\n}\n/**\n * Init graphic element properties with or without animation according to the\n * configuration in series.\n *\n * Caution: this method will stop previous animation.\n * So do not use this method to one element twice before\n * animation starts, unless you know what you are doing.\n *\n * @param {module:zrender/Element} el\n * @param {Object} props\n * @param {module:echarts/model/Model} [animatableModel]\n * @param {number} [dataIndex]\n * @param {Function} cb\n */\n\n\nfunction initProps(el, props, animatableModel, dataIndex, cb) {\n  animateOrSetProps(false, el, props, animatableModel, dataIndex, cb);\n}\n/**\n * Get transform matrix of target (param target),\n * in coordinate of its ancestor (param ancestor)\n *\n * @param {module:zrender/mixin/Transformable} target\n * @param {module:zrender/mixin/Transformable} [ancestor]\n */\n\n\nfunction getTransform(target, ancestor) {\n  var mat = matrix.identity([]);\n\n  while (target && target !== ancestor) {\n    matrix.mul(mat, target.getLocalTransform(), mat);\n    target = target.parent;\n  }\n\n  return mat;\n}\n/**\n * Apply transform to an vertex.\n * @param {Array.<number>} target [x, y]\n * @param {Array.<number>|TypedArray.<number>|Object} transform Can be:\n *      + Transform matrix: like [1, 0, 0, 1, 0, 0]\n *      + {position, rotation, scale}, the same as `zrender/Transformable`.\n * @param {boolean=} invert Whether use invert matrix.\n * @return {Array.<number>} [x, y]\n */\n\n\nfunction applyTransform(target, transform, invert) {\n  if (transform && !zrUtil.isArrayLike(transform)) {\n    transform = Transformable.getLocalTransform(transform);\n  }\n\n  if (invert) {\n    transform = matrix.invert([], transform);\n  }\n\n  return vector.applyTransform([], target, transform);\n}\n/**\n * @param {string} direction 'left' 'right' 'top' 'bottom'\n * @param {Array.<number>} transform Transform matrix: like [1, 0, 0, 1, 0, 0]\n * @param {boolean=} invert Whether use invert matrix.\n * @return {string} Transformed direction. 'left' 'right' 'top' 'bottom'\n */\n\n\nfunction transformDirection(direction, transform, invert) {\n  // Pick a base, ensure that transform result will not be (0, 0).\n  var hBase = transform[4] === 0 || transform[5] === 0 || transform[0] === 0 ? 1 : Math.abs(2 * transform[4] / transform[0]);\n  var vBase = transform[4] === 0 || transform[5] === 0 || transform[2] === 0 ? 1 : Math.abs(2 * transform[4] / transform[2]);\n  var vertex = [direction === 'left' ? -hBase : direction === 'right' ? hBase : 0, direction === 'top' ? -vBase : direction === 'bottom' ? vBase : 0];\n  vertex = applyTransform(vertex, transform, invert);\n  return Math.abs(vertex[0]) > Math.abs(vertex[1]) ? vertex[0] > 0 ? 'right' : 'left' : vertex[1] > 0 ? 'bottom' : 'top';\n}\n/**\n * Apply group transition animation from g1 to g2.\n * If no animatableModel, no animation.\n */\n\n\nfunction groupTransition(g1, g2, animatableModel, cb) {\n  if (!g1 || !g2) {\n    return;\n  }\n\n  function getElMap(g) {\n    var elMap = {};\n    g.traverse(function (el) {\n      if (!el.isGroup && el.anid) {\n        elMap[el.anid] = el;\n      }\n    });\n    return elMap;\n  }\n\n  function getAnimatableProps(el) {\n    var obj = {\n      position: vector.clone(el.position),\n      rotation: el.rotation\n    };\n\n    if (el.shape) {\n      obj.shape = zrUtil.extend({}, el.shape);\n    }\n\n    return obj;\n  }\n\n  var elMap1 = getElMap(g1);\n  g2.traverse(function (el) {\n    if (!el.isGroup && el.anid) {\n      var oldEl = elMap1[el.anid];\n\n      if (oldEl) {\n        var newProp = getAnimatableProps(el);\n        el.attr(getAnimatableProps(oldEl));\n        updateProps(el, newProp, animatableModel, el.dataIndex);\n      } // else {\n      //     if (el.previousProps) {\n      //         graphic.updateProps\n      //     }\n      // }\n\n    }\n  });\n}\n/**\n * @param {Array.<Array.<number>>} points Like: [[23, 44], [53, 66], ...]\n * @param {Object} rect {x, y, width, height}\n * @return {Array.<Array.<number>>} A new clipped points.\n */\n\n\nfunction clipPointsByRect(points, rect) {\n  // FIXME: this way migth be incorrect when grpahic clipped by a corner.\n  // and when element have border.\n  return zrUtil.map(points, function (point) {\n    var x = point[0];\n    x = mathMax(x, rect.x);\n    x = mathMin(x, rect.x + rect.width);\n    var y = point[1];\n    y = mathMax(y, rect.y);\n    y = mathMin(y, rect.y + rect.height);\n    return [x, y];\n  });\n}\n/**\n * @param {Object} targetRect {x, y, width, height}\n * @param {Object} rect {x, y, width, height}\n * @return {Object} A new clipped rect. If rect size are negative, return undefined.\n */\n\n\nfunction clipRectByRect(targetRect, rect) {\n  var x = mathMax(targetRect.x, rect.x);\n  var x2 = mathMin(targetRect.x + targetRect.width, rect.x + rect.width);\n  var y = mathMax(targetRect.y, rect.y);\n  var y2 = mathMin(targetRect.y + targetRect.height, rect.y + rect.height); // If the total rect is cliped, nothing, including the border,\n  // should be painted. So return undefined.\n\n  if (x2 >= x && y2 >= y) {\n    return {\n      x: x,\n      y: y,\n      width: x2 - x,\n      height: y2 - y\n    };\n  }\n}\n/**\n * @param {string} iconStr Support 'image://' or 'path://' or direct svg path.\n * @param {Object} [opt] Properties of `module:zrender/Element`, except `style`.\n * @param {Object} [rect] {x, y, width, height}\n * @return {module:zrender/Element} Icon path or image element.\n */\n\n\nfunction createIcon(iconStr, opt, rect) {\n  opt = zrUtil.extend({\n    rectHover: true\n  }, opt);\n  var style = opt.style = {\n    strokeNoScale: true\n  };\n  rect = rect || {\n    x: -1,\n    y: -1,\n    width: 2,\n    height: 2\n  };\n\n  if (iconStr) {\n    return iconStr.indexOf('image://') === 0 ? (style.image = iconStr.slice(8), zrUtil.defaults(style, rect), new ZImage(opt)) : makePath(iconStr.replace('path://', ''), opt, rect, 'center');\n  }\n}\n/**\n * Return `true` if the given line (line `a`) and the given polygon\n * are intersect.\n * Note that we do not count colinear as intersect here because no\n * requirement for that. We could do that if required in future.\n *\n * @param {number} a1x\n * @param {number} a1y\n * @param {number} a2x\n * @param {number} a2y\n * @param {Array.<Array.<number>>} points Points of the polygon.\n * @return {boolean}\n */\n\n\nfunction linePolygonIntersect(a1x, a1y, a2x, a2y, points) {\n  for (var i = 0, p2 = points[points.length - 1]; i < points.length; i++) {\n    var p = points[i];\n\n    if (lineLineIntersect(a1x, a1y, a2x, a2y, p[0], p[1], p2[0], p2[1])) {\n      return true;\n    }\n\n    p2 = p;\n  }\n}\n/**\n * Return `true` if the given two lines (line `a` and line `b`)\n * are intersect.\n * Note that we do not count colinear as intersect here because no\n * requirement for that. We could do that if required in future.\n *\n * @param {number} a1x\n * @param {number} a1y\n * @param {number} a2x\n * @param {number} a2y\n * @param {number} b1x\n * @param {number} b1y\n * @param {number} b2x\n * @param {number} b2y\n * @return {boolean}\n */\n\n\nfunction lineLineIntersect(a1x, a1y, a2x, a2y, b1x, b1y, b2x, b2y) {\n  // let `vec_m` to be `vec_a2 - vec_a1` and `vec_n` to be `vec_b2 - vec_b1`.\n  var mx = a2x - a1x;\n  var my = a2y - a1y;\n  var nx = b2x - b1x;\n  var ny = b2y - b1y; // `vec_m` and `vec_n` are parallel iff\n  //     exising `k` such that `vec_m = k  vec_n`, equivalent to `vec_m X vec_n = 0`.\n\n  var nmCrossProduct = crossProduct2d(nx, ny, mx, my);\n\n  if (nearZero(nmCrossProduct)) {\n    return false;\n  } // `vec_m` and `vec_n` are intersect iff\n  //     existing `p` and `q` in [0, 1] such that `vec_a1 + p * vec_m = vec_b1 + q * vec_n`,\n  //     such that `q = ((vec_a1 - vec_b1) X vec_m) / (vec_n X vec_m)`\n  //           and `p = ((vec_a1 - vec_b1) X vec_n) / (vec_n X vec_m)`.\n\n\n  var b1a1x = a1x - b1x;\n  var b1a1y = a1y - b1y;\n  var q = crossProduct2d(b1a1x, b1a1y, mx, my) / nmCrossProduct;\n\n  if (q < 0 || q > 1) {\n    return false;\n  }\n\n  var p = crossProduct2d(b1a1x, b1a1y, nx, ny) / nmCrossProduct;\n\n  if (p < 0 || p > 1) {\n    return false;\n  }\n\n  return true;\n}\n/**\n * Cross product of 2-dimension vector.\n */\n\n\nfunction crossProduct2d(x1, y1, x2, y2) {\n  return x1 * y2 - x2 * y1;\n}\n\nfunction nearZero(val) {\n  return val <= 1e-6 && val >= -1e-6;\n} // Register built-in shapes. These shapes might be overwirtten\n// by users, although we do not recommend that.\n\n\nregisterShape('circle', Circle);\nregisterShape('sector', Sector);\nregisterShape('ring', Ring);\nregisterShape('polygon', Polygon);\nregisterShape('polyline', Polyline);\nregisterShape('rect', Rect);\nregisterShape('line', Line);\nregisterShape('bezierCurve', BezierCurve);\nregisterShape('arc', Arc);\nexports.Z2_EMPHASIS_LIFT = Z2_EMPHASIS_LIFT;\nexports.CACHED_LABEL_STYLE_PROPERTIES = CACHED_LABEL_STYLE_PROPERTIES;\nexports.extendShape = extendShape;\nexports.extendPath = extendPath;\nexports.registerShape = registerShape;\nexports.getShapeClass = getShapeClass;\nexports.makePath = makePath;\nexports.makeImage = makeImage;\nexports.mergePath = mergePath;\nexports.resizePath = resizePath;\nexports.subPixelOptimizeLine = subPixelOptimizeLine;\nexports.subPixelOptimizeRect = subPixelOptimizeRect;\nexports.subPixelOptimize = subPixelOptimize;\nexports.setElementHoverStyle = setElementHoverStyle;\nexports.setHoverStyle = setHoverStyle;\nexports.setAsHighDownDispatcher = setAsHighDownDispatcher;\nexports.isHighDownDispatcher = isHighDownDispatcher;\nexports.getHighlightDigit = getHighlightDigit;\nexports.setLabelStyle = setLabelStyle;\nexports.modifyLabelStyle = modifyLabelStyle;\nexports.setTextStyle = setTextStyle;\nexports.setText = setText;\nexports.getFont = getFont;\nexports.updateProps = updateProps;\nexports.initProps = initProps;\nexports.getTransform = getTransform;\nexports.applyTransform = applyTransform;\nexports.transformDirection = transformDirection;\nexports.groupTransition = groupTransition;\nexports.clipPointsByRect = clipPointsByRect;\nexports.clipRectByRect = clipRectByRect;\nexports.createIcon = createIcon;\nexports.linePolygonIntersect = linePolygonIntersect;\nexports.lineLineIntersect = lineLineIntersect;"],"mappings":"AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAIA,MAAM,GAAGC,OAAO,CAAC,uBAAuB,CAAC;AAE7C,IAAIC,QAAQ,GAAGD,OAAO,CAAC,uBAAuB,CAAC;AAE/C,IAAIE,SAAS,GAAGF,OAAO,CAAC,wBAAwB,CAAC;AAEjD,IAAIG,MAAM,GAAGH,OAAO,CAAC,yBAAyB,CAAC;AAE/C,IAAII,MAAM,GAAGJ,OAAO,CAAC,yBAAyB,CAAC;AAE/C,IAAIK,IAAI,GAAGL,OAAO,CAAC,0BAA0B,CAAC;AAE9C,IAAIM,aAAa,GAAGN,OAAO,CAAC,iCAAiC,CAAC;AAE9D,IAAIO,MAAM,GAAGP,OAAO,CAAC,2BAA2B,CAAC;AAEjDQ,OAAO,CAACC,KAAK,GAAGF,MAAM;AAEtB,IAAIG,KAAK,GAAGV,OAAO,CAAC,6BAA6B,CAAC;AAElDQ,OAAO,CAACE,KAAK,GAAGA,KAAK;AAErB,IAAIC,IAAI,GAAGX,OAAO,CAAC,0BAA0B,CAAC;AAE9CQ,OAAO,CAACG,IAAI,GAAGA,IAAI;AAEnB,IAAIC,MAAM,GAAGZ,OAAO,CAAC,kCAAkC,CAAC;AAExDQ,OAAO,CAACI,MAAM,GAAGA,MAAM;AAEvB,IAAIC,MAAM,GAAGb,OAAO,CAAC,kCAAkC,CAAC;AAExDQ,OAAO,CAACK,MAAM,GAAGA,MAAM;AAEvB,IAAIC,IAAI,GAAGd,OAAO,CAAC,gCAAgC,CAAC;AAEpDQ,OAAO,CAACM,IAAI,GAAGA,IAAI;AAEnB,IAAIC,OAAO,GAAGf,OAAO,CAAC,mCAAmC,CAAC;AAE1DQ,OAAO,CAACO,OAAO,GAAGA,OAAO;AAEzB,IAAIC,QAAQ,GAAGhB,OAAO,CAAC,oCAAoC,CAAC;AAE5DQ,OAAO,CAACQ,QAAQ,GAAGA,QAAQ;AAE3B,IAAIC,IAAI,GAAGjB,OAAO,CAAC,gCAAgC,CAAC;AAEpDQ,OAAO,CAACS,IAAI,GAAGA,IAAI;AAEnB,IAAIC,IAAI,GAAGlB,OAAO,CAAC,gCAAgC,CAAC;AAEpDQ,OAAO,CAACU,IAAI,GAAGA,IAAI;AAEnB,IAAIC,WAAW,GAAGnB,OAAO,CAAC,uCAAuC,CAAC;AAElEQ,OAAO,CAACW,WAAW,GAAGA,WAAW;AAEjC,IAAIC,GAAG,GAAGpB,OAAO,CAAC,+BAA+B,CAAC;AAElDQ,OAAO,CAACY,GAAG,GAAGA,GAAG;AAEjB,IAAIC,YAAY,GAAGrB,OAAO,CAAC,kCAAkC,CAAC;AAE9DQ,OAAO,CAACa,YAAY,GAAGA,YAAY;AAEnC,IAAIC,cAAc,GAAGtB,OAAO,CAAC,oCAAoC,CAAC;AAElEQ,OAAO,CAACc,cAAc,GAAGA,cAAc;AAEvC,IAAIC,cAAc,GAAGvB,OAAO,CAAC,oCAAoC,CAAC;AAElEQ,OAAO,CAACe,cAAc,GAAGA,cAAc;AAEvC,IAAIC,YAAY,GAAGxB,OAAO,CAAC,+BAA+B,CAAC;AAE3DQ,OAAO,CAACgB,YAAY,GAAGA,YAAY;AAEnC,IAAIC,sBAAsB,GAAGzB,OAAO,CAAC,4CAA4C,CAAC;AAElFQ,OAAO,CAACiB,sBAAsB,GAAGA,sBAAsB;AAEvD,IAAIC,oBAAoB,GAAG1B,OAAO,CAAC,6CAA6C,CAAC;;AAEjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI2B,OAAO,GAAGC,IAAI,CAACC,GAAG;AACtB,IAAIC,OAAO,GAAGF,IAAI,CAACG,GAAG;AACtB,IAAIC,SAAS,GAAG,CAAC,CAAC;AAClB,IAAIC,gBAAgB,GAAG,CAAC,CAAC,CAAC;;AAE1B,IAAIC,6BAA6B,GAAG;EAClCC,KAAK,EAAE,UAAU;EACjBC,eAAe,EAAE,YAAY;EAC7BC,eAAe,EAAE;AACnB,CAAC;AACD,IAAIC,QAAQ,GAAG,UAAU;AACzB,IAAIC,MAAM,GAAG,QAAQ,CAAC,CAAC;;AAEvB,IAAIC,mBAAmB,GAAG,CAAC;AAC3B,IAAIC,gBAAgB,GAAG,CAAC,CAAC;AACzB,IAAIC,eAAe,GAAG,CAAC,CAAC;AACxB;AACA;AACA;;AAEA,SAASC,WAAWA,CAACC,IAAI,EAAE;EACzB,OAAOvC,IAAI,CAACwC,MAAM,CAACD,IAAI,CAAC;AAC1B;AACA;AACA;AACA;;AAGA,SAASE,UAAUA,CAACC,QAAQ,EAAEH,IAAI,EAAE;EAClC,OAAO3C,QAAQ,CAAC+C,gBAAgB,CAACD,QAAQ,EAAEH,IAAI,CAAC;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,SAASK,aAAaA,CAACC,IAAI,EAAEC,UAAU,EAAE;EACvCT,eAAe,CAACQ,IAAI,CAAC,GAAGC,UAAU;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,SAASC,aAAaA,CAACF,IAAI,EAAE;EAC3B,IAAIR,eAAe,CAACW,cAAc,CAACH,IAAI,CAAC,EAAE;IACxC,OAAOR,eAAe,CAACQ,IAAI,CAAC;EAC9B;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,SAASI,QAAQA,CAACP,QAAQ,EAAEH,IAAI,EAAEW,IAAI,EAAEC,MAAM,EAAE;EAC9C,IAAIC,IAAI,GAAGxD,QAAQ,CAACyD,gBAAgB,CAACX,QAAQ,EAAEH,IAAI,CAAC;EAEpD,IAAIW,IAAI,EAAE;IACR,IAAIC,MAAM,KAAK,QAAQ,EAAE;MACvBD,IAAI,GAAGI,aAAa,CAACJ,IAAI,EAAEE,IAAI,CAACG,eAAe,EAAE,CAAC;IACpD;IAEAC,UAAU,CAACJ,IAAI,EAAEF,IAAI,CAAC;EACxB;EAEA,OAAOE,IAAI;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,SAASK,SAASA,CAACC,QAAQ,EAAER,IAAI,EAAEC,MAAM,EAAE;EACzC,IAAIC,IAAI,GAAG,IAAIlD,MAAM,CAAC;IACpByD,KAAK,EAAE;MACLC,KAAK,EAAEF,QAAQ;MACfG,CAAC,EAAEX,IAAI,CAACW,CAAC;MACTC,CAAC,EAAEZ,IAAI,CAACY,CAAC;MACTC,KAAK,EAAEb,IAAI,CAACa,KAAK;MACjBC,MAAM,EAAEd,IAAI,CAACc;IACf,CAAC;IACDC,MAAM,EAAE,SAAAA,CAAUC,GAAG,EAAE;MACrB,IAAIf,MAAM,KAAK,QAAQ,EAAE;QACvB,IAAIgB,YAAY,GAAG;UACjBJ,KAAK,EAAEG,GAAG,CAACH,KAAK;UAChBC,MAAM,EAAEE,GAAG,CAACF;QACd,CAAC;QACDZ,IAAI,CAACgB,QAAQ,CAACd,aAAa,CAACJ,IAAI,EAAEiB,YAAY,CAAC,CAAC;MAClD;IACF;EACF,CAAC,CAAC;EACF,OAAOf,IAAI;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,SAASE,aAAaA,CAACJ,IAAI,EAAEiB,YAAY,EAAE;EACzC;EACA,IAAIE,MAAM,GAAGF,YAAY,CAACJ,KAAK,GAAGI,YAAY,CAACH,MAAM;EACrD,IAAID,KAAK,GAAGb,IAAI,CAACc,MAAM,GAAGK,MAAM;EAChC,IAAIL,MAAM;EAEV,IAAID,KAAK,IAAIb,IAAI,CAACa,KAAK,EAAE;IACvBC,MAAM,GAAGd,IAAI,CAACc,MAAM;EACtB,CAAC,MAAM;IACLD,KAAK,GAAGb,IAAI,CAACa,KAAK;IAClBC,MAAM,GAAGD,KAAK,GAAGM,MAAM;EACzB;EAEA,IAAIC,EAAE,GAAGpB,IAAI,CAACW,CAAC,GAAGX,IAAI,CAACa,KAAK,GAAG,CAAC;EAChC,IAAIQ,EAAE,GAAGrB,IAAI,CAACY,CAAC,GAAGZ,IAAI,CAACc,MAAM,GAAG,CAAC;EACjC,OAAO;IACLH,CAAC,EAAES,EAAE,GAAGP,KAAK,GAAG,CAAC;IACjBD,CAAC,EAAES,EAAE,GAAGP,MAAM,GAAG,CAAC;IAClBD,KAAK,EAAEA,KAAK;IACZC,MAAM,EAAEA;EACV,CAAC;AACH;AAEA,IAAIQ,SAAS,GAAG5E,QAAQ,CAAC4E,SAAS;AAClC;AACA;AACA;AACA;AACA;;AAEA,SAAShB,UAAUA,CAACJ,IAAI,EAAEF,IAAI,EAAE;EAC9B,IAAI,CAACE,IAAI,CAACqB,cAAc,EAAE;IACxB;EACF;EAEA,IAAIC,QAAQ,GAAGtB,IAAI,CAACG,eAAe,EAAE;EACrC,IAAIoB,CAAC,GAAGD,QAAQ,CAACE,kBAAkB,CAAC1B,IAAI,CAAC;EACzCE,IAAI,CAACqB,cAAc,CAACE,CAAC,CAAC;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,SAASE,oBAAoBA,CAACC,KAAK,EAAE;EACnCzD,oBAAoB,CAACwD,oBAAoB,CAACC,KAAK,CAACC,KAAK,EAAED,KAAK,CAACC,KAAK,EAAED,KAAK,CAACnB,KAAK,CAAC;EAChF,OAAOmB,KAAK;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,SAASE,oBAAoBA,CAACF,KAAK,EAAE;EACnCzD,oBAAoB,CAAC2D,oBAAoB,CAACF,KAAK,CAACC,KAAK,EAAED,KAAK,CAACC,KAAK,EAAED,KAAK,CAACnB,KAAK,CAAC;EAChF,OAAOmB,KAAK;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,IAAIG,gBAAgB,GAAG5D,oBAAoB,CAAC4D,gBAAgB;AAE5D,SAASC,eAAeA,CAACC,YAAY,EAAE;EACrC,OAAOA,YAAY,IAAI,IAAI,IAAIA,YAAY,KAAK,MAAM;AACxD,CAAC,CAAC;;AAGF,IAAIC,cAAc,GAAG1F,MAAM,CAAC2F,aAAa,EAAE;AAC3C,IAAIC,gBAAgB,GAAG,CAAC;AAExB,SAASC,SAASA,CAACzD,KAAK,EAAE;EACxB,IAAI,OAAOA,KAAK,KAAK,QAAQ,EAAE;IAC7B,OAAOA,KAAK;EACd;EAEA,IAAI0D,WAAW,GAAGJ,cAAc,CAACK,GAAG,CAAC3D,KAAK,CAAC;EAE3C,IAAI,CAAC0D,WAAW,EAAE;IAChBA,WAAW,GAAG3F,SAAS,CAAC6F,IAAI,CAAC5D,KAAK,EAAE,CAAC,GAAG,CAAC;IAEzC,IAAIwD,gBAAgB,GAAG,KAAK,EAAE;MAC5BF,cAAc,CAACO,GAAG,CAAC7D,KAAK,EAAE0D,WAAW,CAAC;MACtCF,gBAAgB,EAAE;IACpB;EACF;EAEA,OAAOE,WAAW;AACpB;AAEA,SAASI,eAAeA,CAACC,EAAE,EAAE;EAC3B,IAAI,CAACA,EAAE,CAACC,eAAe,EAAE;IACvB;EACF;EAEAD,EAAE,CAACC,eAAe,GAAG,KAAK;EAC1B,IAAIC,UAAU,GAAGF,EAAE,CAACG,UAAU;EAE9B,IAAI,CAACD,UAAU,EAAE;IACfF,EAAE,CAACI,iBAAiB,GAAGJ,EAAE,CAACK,gBAAgB,GAAG,IAAI;IACjD;EACF;EAEA,IAAIC,WAAW,GAAGN,EAAE,CAACI,iBAAiB,GAAG,CAAC,CAAC;EAC3CJ,EAAE,CAACK,gBAAgB,GAAGL,EAAE,CAACO,EAAE;EAC3B,IAAIC,OAAO,GAAGR,EAAE,CAAClC,KAAK;EAEtB,KAAK,IAAId,IAAI,IAAIkD,UAAU,EAAE;IAC3B;IACA,IAAIA,UAAU,CAAClD,IAAI,CAAC,IAAI,IAAI,EAAE;MAC5BsD,WAAW,CAACtD,IAAI,CAAC,GAAGwD,OAAO,CAACxD,IAAI,CAAC;IACnC;EACF,CAAC,CAAC;;EAGFsD,WAAW,CAACG,IAAI,GAAGD,OAAO,CAACC,IAAI;EAC/BH,WAAW,CAACI,MAAM,GAAGF,OAAO,CAACE,MAAM;AACrC;AAEA,SAASC,mBAAmBA,CAACX,EAAE,EAAE;EAC/B,IAAIY,QAAQ,GAAGZ,EAAE,CAACG,UAAU;EAE5B,IAAI,CAACS,QAAQ,IAAIZ,EAAE,CAACa,aAAa,EAAE;IACjC;EACF;EAEA,IAAIC,EAAE,GAAGd,EAAE,CAACe,IAAI;EAChB,IAAIC,aAAa,GAAGhB,EAAE,CAACgB,aAAa,IAAIF,EAAE,IAAIA,EAAE,CAACG,OAAO,CAACC,IAAI,KAAK,QAAQ;EAC1ElB,EAAE,CAACa,aAAa,GAAGG,aAAa,GAAG,OAAO,GAAG,OAAO;EAEpD,IAAIhB,EAAE,CAACmB,OAAO,IAAI,CAACL,EAAE,IAAId,EAAE,CAACgB,aAAa,EAAE;IACzC;EACF;EAEA,IAAII,QAAQ,GAAGpB,EAAE;EACjB,IAAIqB,WAAW,GAAGrB,EAAE,CAAClC,KAAK;EAE1B,IAAIkD,aAAa,EAAE;IACjBI,QAAQ,GAAGN,EAAE,CAACQ,QAAQ,CAACtB,EAAE,CAAC;IAC1BqB,WAAW,GAAGD,QAAQ,CAACtD,KAAK;EAC9B;EAEAyD,wBAAwB,CAACF,WAAW,CAAC;EAErC,IAAI,CAACL,aAAa,EAAE;IAClBjB,eAAe,CAACqB,QAAQ,CAAC;EAC3B,CAAC,CAAC;EACF;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EAGAC,WAAW,CAACG,UAAU,CAACZ,QAAQ,CAAC;EAChCa,yBAAyB,CAACJ,WAAW,EAAET,QAAQ,EAAE,MAAM,CAAC;EACxDa,yBAAyB,CAACJ,WAAW,EAAET,QAAQ,EAAE,QAAQ,CAAC;EAC1Dc,qBAAqB,CAACL,WAAW,CAAC;EAElC,IAAI,CAACL,aAAa,EAAE;IAClBhB,EAAE,CAAC2B,KAAK,CAAC,KAAK,CAAC;IACf3B,EAAE,CAACO,EAAE,IAAIxE,gBAAgB;EAC3B;AACF;AAEA,SAAS0F,yBAAyBA,CAACJ,WAAW,EAAEnB,UAAU,EAAE0B,IAAI,EAAE;EAChE,IAAI,CAACvC,eAAe,CAACa,UAAU,CAAC0B,IAAI,CAAC,CAAC,IAAIvC,eAAe,CAACgC,WAAW,CAACO,IAAI,CAAC,CAAC,EAAE;IAC5EP,WAAW,CAACO,IAAI,CAAC,GAAGlC,SAAS,CAAC2B,WAAW,CAACO,IAAI,CAAC,CAAC;EAClD;AACF;AAEA,SAASC,iBAAiBA,CAAC7B,EAAE,EAAE;EAC7B,IAAI8B,WAAW,GAAG9B,EAAE,CAACa,aAAa;EAElC,IAAI,CAACiB,WAAW,EAAE;IAChB;EACF;EAEA9B,EAAE,CAACa,aAAa,GAAG,KAAK;EAExB,IAAIb,EAAE,CAACmB,OAAO,EAAE;IACd;EACF;EAEA,IAAIW,WAAW,KAAK,OAAO,EAAE;IAC3B9B,EAAE,CAACe,IAAI,IAAIf,EAAE,CAACe,IAAI,CAACgB,WAAW,CAAC/B,EAAE,CAAC;EACpC,CAAC,MAAM;IACL,IAAIlC,KAAK,GAAGkC,EAAE,CAAClC,KAAK;IACpB,IAAIkE,SAAS,GAAGhC,EAAE,CAACI,iBAAiB;IAEpC,IAAI4B,SAAS,EAAE;MACbT,wBAAwB,CAACzD,KAAK,CAAC;MAC/BkC,EAAE,CAACzB,QAAQ,CAACyD,SAAS,CAAC;MACtBN,qBAAqB,CAAC5D,KAAK,CAAC;IAC9B,CAAC,CAAC;IACF;IACA;;IAGA,IAAImE,QAAQ,GAAGjC,EAAE,CAACK,gBAAgB;IAElC,IAAI4B,QAAQ,IAAI,IAAI,IAAIjC,EAAE,CAACO,EAAE,GAAG0B,QAAQ,KAAKlG,gBAAgB,EAAE;MAC7DiE,EAAE,CAACO,EAAE,GAAG0B,QAAQ;IAClB;EACF;AACF;AAEA,SAASC,cAAcA,CAAClC,EAAE,EAAEmC,OAAO,EAAEC,WAAW,EAAE;EAChD;EACA,IAAIC,SAAS,GAAGhG,MAAM;EACtB,IAAIiG,OAAO,GAAGjG,MAAM;EACpB,IAAIkG,OAAO,CAAC,CAAC;;EAEbvC,EAAE,CAACa,aAAa,KAAKwB,SAAS,GAAGjG,QAAQ,EAAEmG,OAAO,GAAG,IAAI,CAAC;EAC1DJ,OAAO,CAACnC,EAAE,EAAEoC,WAAW,CAAC;EACxBpC,EAAE,CAACa,aAAa,KAAKyB,OAAO,GAAGlG,QAAQ,EAAEmG,OAAO,GAAG,IAAI,CAAC;EACxDvC,EAAE,CAACmB,OAAO,IAAInB,EAAE,CAACwC,QAAQ,CAAC,UAAUC,KAAK,EAAE;IACzC,CAACA,KAAK,CAACtB,OAAO,IAAIgB,OAAO,CAACM,KAAK,EAAEL,WAAW,CAAC;EAC/C,CAAC,CAAC;EACFG,OAAO,IAAIvC,EAAE,CAAC0C,kBAAkB,IAAI1C,EAAE,CAAC0C,kBAAkB,CAACL,SAAS,EAAEC,OAAO,CAAC;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,SAASK,oBAAoBA,CAAC3C,EAAE,EAAEY,QAAQ,EAAE;EAC1C;EACA;EACAA,QAAQ,GAAGZ,EAAE,CAACG,UAAU,GAAGS,QAAQ,KAAK,KAAK,KAAKZ,EAAE,CAACE,UAAU,IAAIU,QAAQ,IAAI,CAAC,CAAC,CAAC;EAClFZ,EAAE,CAACC,eAAe,GAAG,IAAI,CAAC,CAAC;EAC3B;EACA;EACA;EACA;EACA;;EAEA,IAAID,EAAE,CAACa,aAAa,EAAE;IACpB;IACA;IACA;IACA;IACAb,EAAE,CAACI,iBAAiB,GAAG,IAAI,CAAC,CAAC;IAC7B;IACA;IACA;;IAEAyB,iBAAiB,CAAC7B,EAAE,CAAC;IACrBW,mBAAmB,CAACX,EAAE,CAAC;EACzB;AACF;AAEA,SAAS4C,kBAAkBA,CAACC,CAAC,EAAE;EAC7B,CAACC,YAAY,CAAC,IAAI,EAAED,CAAC,CAAC,CAAC;EAAA,GACpB,CAAC,IAAI,CAACE,aAAa,IAAIb,cAAc,CAAC,IAAI,EAAEvB,mBAAmB,CAAC;AACrE;AAEA,SAASqC,iBAAiBA,CAACH,CAAC,EAAE;EAC5B,CAACC,YAAY,CAAC,IAAI,EAAED,CAAC,CAAC,CAAC;EAAA,GACpB,CAAC,IAAI,CAACE,aAAa,IAAIb,cAAc,CAAC,IAAI,EAAEL,iBAAiB,CAAC;AACnE;AAEA,SAASoB,sBAAsBA,CAACC,cAAc,EAAE;EAC9C,IAAI,CAACH,aAAa,IAAI,CAAC,KAAKG,cAAc,IAAI,CAAC,CAAC;EAChDhB,cAAc,CAAC,IAAI,EAAEvB,mBAAmB,CAAC;AAC3C;AAEA,SAASwC,oBAAoBA,CAACD,cAAc,EAAE;EAC5C,EAAE,IAAI,CAACH,aAAa,IAAI,EAAE,CAAC,KAAKG,cAAc,IAAI,CAAC,CAAC,CAAC,CAAC,IAAIhB,cAAc,CAAC,IAAI,EAAEL,iBAAiB,CAAC;AACnG;AAEA,SAASiB,YAAYA,CAAC9C,EAAE,EAAE6C,CAAC,EAAE;EAC3B,OAAO7C,EAAE,CAACoD,uBAAuB,IAAIP,CAAC,CAACQ,SAAS;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,SAASC,aAAaA,CAACtD,EAAE,EAAEE,UAAU,EAAE;EACrCqD,uBAAuB,CAACvD,EAAE,EAAE,IAAI,CAAC;EACjCkC,cAAc,CAAClC,EAAE,EAAE2C,oBAAoB,EAAEzC,UAAU,CAAC;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,SAASqD,uBAAuBA,CAACvD,EAAE,EAAEwD,YAAY,EAAE;EACjD,IAAIC,OAAO,GAAGD,YAAY,KAAK,KAAK,CAAC,CAAC;EACtC;;EAEAxD,EAAE,CAACoD,uBAAuB,GAAGpD,EAAE,CAAC0D,qBAAqB;EACrD1D,EAAE,CAAC0C,kBAAkB,GAAG1C,EAAE,CAAC2D,gBAAgB,CAAC,CAAC;EAC7C;;EAEA,IAAI,CAACF,OAAO,IAAIzD,EAAE,CAAC4D,oBAAoB,EAAE;IACvC,IAAIC,MAAM,GAAGJ,OAAO,GAAG,KAAK,GAAG,IAAI,CAAC,CAAC;;IAErCzD,EAAE,CAAC6D,MAAM,CAAC,CAAC,WAAW,EAAEjB,kBAAkB,CAAC,CAACiB,MAAM,CAAC,CAAC,UAAU,EAAEb,iBAAiB,CAAC,CAAC,CAAC;;IAEpFhD,EAAE,CAAC6D,MAAM,CAAC,CAAC,UAAU,EAAEZ,sBAAsB,CAAC,CAACY,MAAM,CAAC,CAAC,QAAQ,EAAEV,oBAAoB,CAAC,CAAC,CAAC;;IAExFnD,EAAE,CAAC+C,aAAa,GAAG/C,EAAE,CAAC+C,aAAa,IAAI,CAAC;IACxC/C,EAAE,CAAC4D,oBAAoB,GAAG,CAACH,OAAO;EACpC;AACF;AACA;AACA;AACA;AACA;;AAGA,SAASK,oBAAoBA,CAAC9D,EAAE,EAAE;EAChC,OAAO,CAAC,EAAEA,EAAE,IAAIA,EAAE,CAAC4D,oBAAoB,CAAC;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,SAASG,iBAAiBA,CAACC,YAAY,EAAE;EACvC,IAAId,cAAc,GAAG3G,gBAAgB,CAACyH,YAAY,CAAC;EAEnD,IAAId,cAAc,IAAI,IAAI,IAAI5G,mBAAmB,IAAI,EAAE,EAAE;IACvD4G,cAAc,GAAG3G,gBAAgB,CAACyH,YAAY,CAAC,GAAG1H,mBAAmB,EAAE;EACzE;EAEA,OAAO4G,cAAc;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,SAASe,aAAaA,CAAC3D,WAAW,EAAE4D,aAAa,EAAEC,WAAW,EAAEC,aAAa,EAAEC,GAAG,EAAEC,eAAe,EAAEC,iBAAiB,EAAE;EACtHF,GAAG,GAAGA,GAAG,IAAIvI,SAAS;EACtB,IAAI0I,YAAY,GAAGH,GAAG,CAACG,YAAY;EACnC,IAAIC,cAAc,GAAGJ,GAAG,CAACI,cAAc;EACvC,IAAIC,aAAa,GAAGL,GAAG,CAACK,aAAa;EACrC,IAAIC,SAAS,GAAGN,GAAG,CAACM,SAAS,CAAC,CAAC;EAC/B;;EAEA,IAAIC,UAAU,GAAGT,WAAW,CAACU,UAAU,CAAC,MAAM,CAAC;EAC/C,IAAIC,YAAY,GAAGV,aAAa,CAACS,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC;EACrD;EACA;;EAEA,IAAIE,QAAQ;EAEZ,IAAIH,UAAU,IAAIE,YAAY,EAAE;IAC9B,IAAIN,YAAY,EAAE;MAChBO,QAAQ,GAAGP,YAAY,CAACQ,iBAAiB,CAACP,cAAc,EAAE,QAAQ,EAAE,IAAI,EAAEC,aAAa,EAAEC,SAAS,CAAC;IACrG;IAEA,IAAII,QAAQ,IAAI,IAAI,EAAE;MACpBA,QAAQ,GAAGlL,MAAM,CAACoL,UAAU,CAACZ,GAAG,CAACa,WAAW,CAAC,GAAGb,GAAG,CAACa,WAAW,CAACT,cAAc,EAAEJ,GAAG,CAAC,GAAGA,GAAG,CAACa,WAAW;IACxG;EACF;EAEA,IAAIC,eAAe,GAAGP,UAAU,GAAGG,QAAQ,GAAG,IAAI;EAClD,IAAIK,iBAAiB,GAAGN,YAAY,GAAGjL,MAAM,CAACwL,SAAS,CAACb,YAAY,GAAGA,YAAY,CAACQ,iBAAiB,CAACP,cAAc,EAAE,UAAU,EAAE,IAAI,EAAEC,aAAa,EAAEC,SAAS,CAAC,GAAG,IAAI,EAAEI,QAAQ,CAAC,GAAG,IAAI,CAAC,CAAC;;EAE5L,IAAII,eAAe,IAAI,IAAI,IAAIC,iBAAiB,IAAI,IAAI,EAAE;IACxD;IACA;IACA;IACA;IACA;IACA;IACAE,YAAY,CAAChF,WAAW,EAAE6D,WAAW,EAAEG,eAAe,EAAED,GAAG,CAAC;IAC5DiB,YAAY,CAACpB,aAAa,EAAEE,aAAa,EAAEG,iBAAiB,EAAEF,GAAG,EAAE,IAAI,CAAC;EAC1E;EAEA/D,WAAW,CAACiF,IAAI,GAAGJ,eAAe;EAClCjB,aAAa,CAACqB,IAAI,GAAGH,iBAAiB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,SAASI,gBAAgBA,CAACxF,EAAE,EAAEyF,gBAAgB,EAAEC,kBAAkB,EAAE;EAClE,IAAIlF,OAAO,GAAGR,EAAE,CAAClC,KAAK;EAEtB,IAAI2H,gBAAgB,EAAE;IACpBlE,wBAAwB,CAACf,OAAO,CAAC;IACjCR,EAAE,CAACzB,QAAQ,CAACkH,gBAAgB,CAAC;IAC7B/D,qBAAqB,CAAClB,OAAO,CAAC;EAChC;EAEAA,OAAO,GAAGR,EAAE,CAACG,UAAU;EAEvB,IAAIuF,kBAAkB,IAAIlF,OAAO,EAAE;IACjCe,wBAAwB,CAACf,OAAO,CAAC;IACjC3G,MAAM,CAAC8C,MAAM,CAAC6D,OAAO,EAAEkF,kBAAkB,CAAC;IAC1ChE,qBAAqB,CAAClB,OAAO,CAAC;EAChC;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,SAAS8E,YAAYA,CAACK,SAAS,EAAEC,cAAc,EAAEC,kBAAkB,EAAExB,GAAG,EAAEyB,UAAU,EAAE;EACpFC,kBAAkB,CAACJ,SAAS,EAAEC,cAAc,EAAEvB,GAAG,EAAEyB,UAAU,CAAC;EAC9DD,kBAAkB,IAAIhM,MAAM,CAAC8C,MAAM,CAACgJ,SAAS,EAAEE,kBAAkB,CAAC,CAAC,CAAC;;EAEpE,OAAOF,SAAS;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,SAASK,OAAOA,CAACL,SAAS,EAAEM,UAAU,EAAEC,YAAY,EAAE;EACpD,IAAI7B,GAAG,GAAG;IACR8B,UAAU,EAAE;EACd,CAAC;EACD,IAAIL,UAAU;EAEd,IAAII,YAAY,KAAK,KAAK,EAAE;IAC1BJ,UAAU,GAAG,IAAI;EACnB,CAAC,MAAM;IACL;IACAzB,GAAG,CAAC+B,SAAS,GAAGF,YAAY;EAC9B;EAEAH,kBAAkB,CAACJ,SAAS,EAAEM,UAAU,EAAE5B,GAAG,EAAEyB,UAAU,CAAC,CAAC,CAAC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,SAASC,kBAAkBA,CAACJ,SAAS,EAAEC,cAAc,EAAEvB,GAAG,EAAEyB,UAAU,EAAE;EACtE;EACAzB,GAAG,GAAGA,GAAG,IAAIvI,SAAS;EAEtB,IAAIuI,GAAG,CAAC8B,UAAU,EAAE;IAClB,IAAIE,YAAY;IAEhB,IAAIhC,GAAG,CAACiC,eAAe,EAAE;MACvBD,YAAY,GAAGhC,GAAG,CAACiC,eAAe,CAACV,cAAc,EAAEE,UAAU,CAAC;IAChE,CAAC,MAAM;MACLO,YAAY,GAAGT,cAAc,CAACf,UAAU,CAAC,UAAU,CAAC,KAAKiB,UAAU,GAAG,IAAI,GAAG,QAAQ,CAAC,CAAC,CAAC;MACxF;;MAEAO,YAAY,KAAK,SAAS,KAAKA,YAAY,GAAG,KAAK,CAAC;IACtD;IAEAV,SAAS,CAACU,YAAY,GAAGA,YAAY;IACrCV,SAAS,CAACY,UAAU,GAAGX,cAAc,CAACf,UAAU,CAAC,QAAQ,CAAC;IAC1D,IAAI2B,WAAW,GAAGZ,cAAc,CAACf,UAAU,CAAC,QAAQ,CAAC;IACrD2B,WAAW,IAAI,IAAI,KAAKA,WAAW,IAAI9K,IAAI,CAAC+K,EAAE,GAAG,GAAG,CAAC;IACrDd,SAAS,CAACe,YAAY,GAAGF,WAAW;IACpCb,SAAS,CAACgB,YAAY,GAAG9M,MAAM,CAACwL,SAAS,CAACO,cAAc,CAACf,UAAU,CAAC,UAAU,CAAC,EAAEiB,UAAU,GAAG,IAAI,GAAG,CAAC,CAAC;EACzG;EAEA,IAAIc,OAAO,GAAGhB,cAAc,CAACgB,OAAO;EACpC,IAAIC,eAAe,GAAGD,OAAO,IAAIA,OAAO,CAACE,MAAM,CAACnB,SAAS,CAAC,CAAC;EAC3D;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EAEA,IAAIoB,aAAa,GAAGC,gBAAgB,CAACpB,cAAc,CAAC;EACpD,IAAIqB,UAAU;EAEd,IAAIF,aAAa,EAAE;IACjBE,UAAU,GAAG,CAAC,CAAC;IAEf,KAAK,IAAIjK,IAAI,IAAI+J,aAAa,EAAE;MAC9B,IAAIA,aAAa,CAAC5J,cAAc,CAACH,IAAI,CAAC,EAAE;QACtC;QACA,IAAIkK,aAAa,GAAGtB,cAAc,CAACuB,QAAQ,CAAC,CAAC,MAAM,EAAEnK,IAAI,CAAC,CAAC,CAAC,CAAC;QAC7D;QACA;QACA;QACA;;QAEAoK,iBAAiB,CAACH,UAAU,CAACjK,IAAI,CAAC,GAAG,CAAC,CAAC,EAAEkK,aAAa,EAAEL,eAAe,EAAExC,GAAG,EAAEyB,UAAU,CAAC;MAC3F;IACF;EACF;EAEAH,SAAS,CAAC0B,IAAI,GAAGJ,UAAU;EAC3BG,iBAAiB,CAACzB,SAAS,EAAEC,cAAc,EAAEiB,eAAe,EAAExC,GAAG,EAAEyB,UAAU,EAAE,IAAI,CAAC;EAEpF,IAAIzB,GAAG,CAACiD,SAAS,IAAI,CAACjD,GAAG,CAACsB,SAAS,EAAE;IACnCtB,GAAG,CAACsB,SAAS,GAAG,CAAC,CAAC;EACpB;EAEA,OAAOA,SAAS;AAClB,CAAC,CAAC;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,SAASqB,gBAAgBA,CAACpB,cAAc,EAAE;EACxC;EACA,IAAI2B,eAAe;EAEnB,OAAO3B,cAAc,IAAIA,cAAc,KAAKA,cAAc,CAACgB,OAAO,EAAE;IAClE,IAAIS,IAAI,GAAG,CAACzB,cAAc,CAACkB,MAAM,IAAIhL,SAAS,EAAEuL,IAAI;IAEpD,IAAIA,IAAI,EAAE;MACRE,eAAe,GAAGA,eAAe,IAAI,CAAC,CAAC;MAEvC,KAAK,IAAIvK,IAAI,IAAIqK,IAAI,EAAE;QACrB,IAAIA,IAAI,CAAClK,cAAc,CAACH,IAAI,CAAC,EAAE;UAC7BuK,eAAe,CAACvK,IAAI,CAAC,GAAG,CAAC;QAC3B;MACF;IACF;IAEA4I,cAAc,GAAGA,cAAc,CAAC4B,WAAW;EAC7C;EAEA,OAAOD,eAAe;AACxB;AAEA,SAASH,iBAAiBA,CAACzB,SAAS,EAAEC,cAAc,EAAEiB,eAAe,EAAExC,GAAG,EAAEyB,UAAU,EAAE2B,OAAO,EAAE;EAC/F;EACAZ,eAAe,GAAG,CAACf,UAAU,IAAIe,eAAe,IAAI/K,SAAS;EAC7D6J,SAAS,CAAC+B,QAAQ,GAAGC,YAAY,CAAC/B,cAAc,CAACf,UAAU,CAAC,OAAO,CAAC,EAAER,GAAG,CAAC,IAAIwC,eAAe,CAAC5K,KAAK;EACnG0J,SAAS,CAACiC,UAAU,GAAGD,YAAY,CAAC/B,cAAc,CAACf,UAAU,CAAC,iBAAiB,CAAC,EAAER,GAAG,CAAC,IAAIwC,eAAe,CAAC3K,eAAe;EACzHyJ,SAAS,CAACkC,eAAe,GAAGhO,MAAM,CAACwL,SAAS,CAACO,cAAc,CAACf,UAAU,CAAC,iBAAiB,CAAC,EAAEgC,eAAe,CAAC1K,eAAe,CAAC;EAE3H,IAAI,CAAC2J,UAAU,EAAE;IACf,IAAI2B,OAAO,EAAE;MACX9B,SAAS,CAACmC,iBAAiB,GAAGzD,GAAG;MACjC3C,qBAAqB,CAACiE,SAAS,CAAC;IAClC,CAAC,CAAC;;IAGF,IAAIA,SAAS,CAAC+B,QAAQ,IAAI,IAAI,EAAE;MAC9B/B,SAAS,CAAC+B,QAAQ,GAAGrD,GAAG,CAAC+B,SAAS;IACpC;EACF,CAAC,CAAC;EACF;EACA;;EAGAT,SAAS,CAACoC,SAAS,GAAGnC,cAAc,CAACf,UAAU,CAAC,WAAW,CAAC,IAAIgC,eAAe,CAACkB,SAAS;EACzFpC,SAAS,CAACqC,UAAU,GAAGpC,cAAc,CAACf,UAAU,CAAC,YAAY,CAAC,IAAIgC,eAAe,CAACmB,UAAU;EAC5FrC,SAAS,CAACsC,QAAQ,GAAGrC,cAAc,CAACf,UAAU,CAAC,UAAU,CAAC,IAAIgC,eAAe,CAACoB,QAAQ;EACtFtC,SAAS,CAACuC,UAAU,GAAGtC,cAAc,CAACf,UAAU,CAAC,YAAY,CAAC,IAAIgC,eAAe,CAACqB,UAAU;EAC5FvC,SAAS,CAACwC,SAAS,GAAGvC,cAAc,CAACf,UAAU,CAAC,OAAO,CAAC;EACxDc,SAAS,CAACyC,iBAAiB,GAAGxC,cAAc,CAACf,UAAU,CAAC,eAAe,CAAC,IAAIe,cAAc,CAACf,UAAU,CAAC,UAAU,CAAC;EACjHc,SAAS,CAAC0C,cAAc,GAAGzC,cAAc,CAACf,UAAU,CAAC,YAAY,CAAC;EAClEc,SAAS,CAAC2C,SAAS,GAAG1C,cAAc,CAACf,UAAU,CAAC,OAAO,CAAC;EACxDc,SAAS,CAAC4C,UAAU,GAAG3C,cAAc,CAACf,UAAU,CAAC,QAAQ,CAAC;EAC1Dc,SAAS,CAAC6C,OAAO,GAAG5C,cAAc,CAACf,UAAU,CAAC,KAAK,CAAC;EAEpD,IAAI,CAAC4C,OAAO,IAAI,CAACpD,GAAG,CAACoE,UAAU,EAAE;IAC/B9C,SAAS,CAAC+C,mBAAmB,GAAGf,YAAY,CAAC/B,cAAc,CAACf,UAAU,CAAC,iBAAiB,CAAC,EAAER,GAAG,CAAC;IAC/FsB,SAAS,CAACgD,WAAW,GAAG/C,cAAc,CAACf,UAAU,CAAC,SAAS,CAAC;IAC5Dc,SAAS,CAACzJ,eAAe,GAAGyL,YAAY,CAAC/B,cAAc,CAACf,UAAU,CAAC,aAAa,CAAC,EAAER,GAAG,CAAC;IACvFsB,SAAS,CAACxJ,eAAe,GAAGyJ,cAAc,CAACf,UAAU,CAAC,aAAa,CAAC;IACpEc,SAAS,CAACiD,gBAAgB,GAAGhD,cAAc,CAACf,UAAU,CAAC,cAAc,CAAC;IACtEc,SAAS,CAACkD,kBAAkB,GAAGjD,cAAc,CAACf,UAAU,CAAC,aAAa,CAAC;IACvEc,SAAS,CAACmD,iBAAiB,GAAGlD,cAAc,CAACf,UAAU,CAAC,YAAY,CAAC;IACrEc,SAAS,CAACoD,oBAAoB,GAAGnD,cAAc,CAACf,UAAU,CAAC,eAAe,CAAC;IAC3Ec,SAAS,CAACqD,oBAAoB,GAAGpD,cAAc,CAACf,UAAU,CAAC,eAAe,CAAC;EAC7E;EAEAc,SAAS,CAACsD,eAAe,GAAGrD,cAAc,CAACf,UAAU,CAAC,iBAAiB,CAAC,IAAIgC,eAAe,CAACoC,eAAe;EAC3GtD,SAAS,CAACuD,cAAc,GAAGtD,cAAc,CAACf,UAAU,CAAC,gBAAgB,CAAC,IAAIgC,eAAe,CAACqC,cAAc;EACxGvD,SAAS,CAACwD,iBAAiB,GAAGvD,cAAc,CAACf,UAAU,CAAC,mBAAmB,CAAC,IAAIgC,eAAe,CAACsC,iBAAiB;EACjHxD,SAAS,CAACyD,iBAAiB,GAAGxD,cAAc,CAACf,UAAU,CAAC,mBAAmB,CAAC,IAAIgC,eAAe,CAACuC,iBAAiB;AACnH;AAEA,SAASzB,YAAYA,CAAC1L,KAAK,EAAEoI,GAAG,EAAE;EAChC,OAAOpI,KAAK,KAAK,MAAM,GAAGA,KAAK,GAAGoI,GAAG,IAAIA,GAAG,CAAC+B,SAAS,GAAG/B,GAAG,CAAC+B,SAAS,GAAG,IAAI;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,SAAS1E,qBAAqBA,CAACiE,SAAS,EAAE;EACxC,IAAIU,YAAY,GAAGV,SAAS,CAACU,YAAY;EACzC,IAAIhC,GAAG,GAAGsB,SAAS,CAACmC,iBAAiB;EACrC,IAAIuB,cAAc;EAElB,IAAIhF,GAAG,IAAIsB,SAAS,CAAC+B,QAAQ,IAAI,IAAI,EAAE;IACrC,IAAItB,SAAS,GAAG/B,GAAG,CAAC+B,SAAS;IAC7B,IAAID,UAAU,GAAG9B,GAAG,CAAC8B,UAAU;IAC/B,IAAImD,cAAc,GAAGjF,GAAG,CAACiF,cAAc;IACvC,IAAIC,mBAAmB,GAAGD,cAAc,KAAK,KAAK,KAAKA,cAAc,KAAK,IAAI,IAAInD,UAAU,IAAIE,YAAY,CAAC;IAAA,GAC1G,OAAOA,YAAY,KAAK,QAAQ,IAAIA,YAAY,CAACmD,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;IAC3E,IAAIC,iBAAiB,GAAG,CAACF,mBAAmB,IAAInD,SAAS,IAAI,IAAI,CAAC,CAAC;;IAEnE,IAAImD,mBAAmB,IAAIE,iBAAiB,EAAE;MAC5CJ,cAAc,GAAG;QACf3B,QAAQ,EAAE/B,SAAS,CAAC+B,QAAQ;QAC5BE,UAAU,EAAEjC,SAAS,CAACiC,UAAU;QAChCC,eAAe,EAAElC,SAAS,CAACkC;MAC7B,CAAC;IACH;IAEA,IAAI0B,mBAAmB,EAAE;MACvB5D,SAAS,CAAC+B,QAAQ,GAAG,MAAM,CAAC,CAAC;;MAE7B,IAAI/B,SAAS,CAACiC,UAAU,IAAI,IAAI,EAAE;QAChCjC,SAAS,CAACiC,UAAU,GAAGxB,SAAS;QAChCT,SAAS,CAACkC,eAAe,IAAI,IAAI,KAAKlC,SAAS,CAACkC,eAAe,GAAG,CAAC,CAAC;MACtE;IACF;IAEA,IAAI4B,iBAAiB,EAAE;MACrB9D,SAAS,CAAC+B,QAAQ,GAAGtB,SAAS;IAChC;EACF,CAAC,CAAC;;EAGFT,SAAS,CAAC0D,cAAc,GAAGA,cAAc;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,SAAS9H,wBAAwBA,CAACzD,KAAK,EAAE;EACvC,IAAIuL,cAAc,GAAGvL,KAAK,CAACuL,cAAc;EAEzC,IAAIA,cAAc,EAAE;IAClB;IACAvL,KAAK,CAAC4J,QAAQ,GAAG2B,cAAc,CAAC3B,QAAQ;IACxC5J,KAAK,CAAC8J,UAAU,GAAGyB,cAAc,CAACzB,UAAU;IAC5C9J,KAAK,CAAC+J,eAAe,GAAGwB,cAAc,CAACxB,eAAe;IACtD/J,KAAK,CAACuL,cAAc,GAAG,IAAI;EAC7B;AACF;AAEA,SAASK,OAAOA,CAACrF,GAAG,EAAEuC,OAAO,EAAE;EAC7B,IAAI+C,eAAe,GAAG/C,OAAO,IAAIA,OAAO,CAACO,QAAQ,CAAC,WAAW,CAAC;EAC9D,OAAOtN,MAAM,CAAC+P,IAAI,CAAC;EAAC;EACpBvF,GAAG,CAAC0D,SAAS,IAAI4B,eAAe,IAAIA,eAAe,CAAC9E,UAAU,CAAC,WAAW,CAAC,IAAI,EAAE,EAAER,GAAG,CAAC2D,UAAU,IAAI2B,eAAe,IAAIA,eAAe,CAAC9E,UAAU,CAAC,YAAY,CAAC,IAAI,EAAE,EAAE,CAACR,GAAG,CAAC4D,QAAQ,IAAI0B,eAAe,IAAIA,eAAe,CAAC9E,UAAU,CAAC,UAAU,CAAC,IAAI,EAAE,IAAI,IAAI,EAAER,GAAG,CAAC6D,UAAU,IAAIyB,eAAe,IAAIA,eAAe,CAAC9E,UAAU,CAAC,YAAY,CAAC,IAAI,YAAY,CAAC,CAACgF,IAAI,CAAC,GAAG,CAAC,CAAC;AAC7W;AAEA,SAASC,iBAAiBA,CAACC,QAAQ,EAAE/J,EAAE,EAAEgK,KAAK,EAAEC,eAAe,EAAEC,SAAS,EAAEC,EAAE,EAAE;EAC9E,IAAI,OAAOD,SAAS,KAAK,UAAU,EAAE;IACnCC,EAAE,GAAGD,SAAS;IACdA,SAAS,GAAG,IAAI;EAClB,CAAC,CAAC;EACF;EACA;;EAGA,IAAIE,gBAAgB,GAAGH,eAAe,IAAIA,eAAe,CAACI,kBAAkB,EAAE;EAE9E,IAAID,gBAAgB,EAAE;IACpB,IAAIE,OAAO,GAAGP,QAAQ,GAAG,QAAQ,GAAG,EAAE;IACtC,IAAIQ,QAAQ,GAAGN,eAAe,CAACpF,UAAU,CAAC,mBAAmB,GAAGyF,OAAO,CAAC;IACxE,IAAIE,eAAe,GAAGP,eAAe,CAACpF,UAAU,CAAC,iBAAiB,GAAGyF,OAAO,CAAC;IAC7E,IAAIG,cAAc,GAAGR,eAAe,CAACpF,UAAU,CAAC,gBAAgB,GAAGyF,OAAO,CAAC;IAE3E,IAAI,OAAOG,cAAc,KAAK,UAAU,EAAE;MACxCA,cAAc,GAAGA,cAAc,CAACP,SAAS,EAAED,eAAe,CAACS,uBAAuB,GAAGT,eAAe,CAACS,uBAAuB,CAAC1K,EAAE,EAAEkK,SAAS,CAAC,GAAG,IAAI,CAAC;IACrJ;IAEA,IAAI,OAAOK,QAAQ,KAAK,UAAU,EAAE;MAClCA,QAAQ,GAAGA,QAAQ,CAACL,SAAS,CAAC;IAChC;IAEAK,QAAQ,GAAG,CAAC,GAAGvK,EAAE,CAAC2K,SAAS,CAACX,KAAK,EAAEO,QAAQ,EAAEE,cAAc,IAAI,CAAC,EAAED,eAAe,EAAEL,EAAE,EAAE,CAAC,CAACA,EAAE,CAAC,IAAInK,EAAE,CAAC4K,aAAa,EAAE,EAAE5K,EAAE,CAAC6K,IAAI,CAACb,KAAK,CAAC,EAAEG,EAAE,IAAIA,EAAE,EAAE,CAAC;EACjJ,CAAC,MAAM;IACLnK,EAAE,CAAC4K,aAAa,EAAE;IAClB5K,EAAE,CAAC6K,IAAI,CAACb,KAAK,CAAC;IACdG,EAAE,IAAIA,EAAE,EAAE;EACZ;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,SAASW,WAAWA,CAAC9K,EAAE,EAAEgK,KAAK,EAAEC,eAAe,EAAEC,SAAS,EAAEC,EAAE,EAAE;EAC9DL,iBAAiB,CAAC,IAAI,EAAE9J,EAAE,EAAEgK,KAAK,EAAEC,eAAe,EAAEC,SAAS,EAAEC,EAAE,CAAC;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,SAASY,SAASA,CAAC/K,EAAE,EAAEgK,KAAK,EAAEC,eAAe,EAAEC,SAAS,EAAEC,EAAE,EAAE;EAC5DL,iBAAiB,CAAC,KAAK,EAAE9J,EAAE,EAAEgK,KAAK,EAAEC,eAAe,EAAEC,SAAS,EAAEC,EAAE,CAAC;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,SAASa,YAAYA,CAACC,MAAM,EAAEC,QAAQ,EAAE;EACtC,IAAIC,GAAG,GAAGlR,MAAM,CAACmR,QAAQ,CAAC,EAAE,CAAC;EAE7B,OAAOH,MAAM,IAAIA,MAAM,KAAKC,QAAQ,EAAE;IACpCjR,MAAM,CAACoR,GAAG,CAACF,GAAG,EAAEF,MAAM,CAACK,iBAAiB,EAAE,EAAEH,GAAG,CAAC;IAChDF,MAAM,GAAGA,MAAM,CAACM,MAAM;EACxB;EAEA,OAAOJ,GAAG;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,SAASvM,cAAcA,CAACqM,MAAM,EAAEO,SAAS,EAAEC,MAAM,EAAE;EACjD,IAAID,SAAS,IAAI,CAAC3R,MAAM,CAAC6R,WAAW,CAACF,SAAS,CAAC,EAAE;IAC/CA,SAAS,GAAGpR,aAAa,CAACkR,iBAAiB,CAACE,SAAS,CAAC;EACxD;EAEA,IAAIC,MAAM,EAAE;IACVD,SAAS,GAAGvR,MAAM,CAACwR,MAAM,CAAC,EAAE,EAAED,SAAS,CAAC;EAC1C;EAEA,OAAOtR,MAAM,CAAC0E,cAAc,CAAC,EAAE,EAAEqM,MAAM,EAAEO,SAAS,CAAC;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,SAASG,kBAAkBA,CAACC,SAAS,EAAEJ,SAAS,EAAEC,MAAM,EAAE;EACxD;EACA,IAAII,KAAK,GAAGL,SAAS,CAAC,CAAC,CAAC,KAAK,CAAC,IAAIA,SAAS,CAAC,CAAC,CAAC,KAAK,CAAC,IAAIA,SAAS,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,GAAG9P,IAAI,CAACoQ,GAAG,CAAC,CAAC,GAAGN,SAAS,CAAC,CAAC,CAAC,GAAGA,SAAS,CAAC,CAAC,CAAC,CAAC;EAC1H,IAAIO,KAAK,GAAGP,SAAS,CAAC,CAAC,CAAC,KAAK,CAAC,IAAIA,SAAS,CAAC,CAAC,CAAC,KAAK,CAAC,IAAIA,SAAS,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,GAAG9P,IAAI,CAACoQ,GAAG,CAAC,CAAC,GAAGN,SAAS,CAAC,CAAC,CAAC,GAAGA,SAAS,CAAC,CAAC,CAAC,CAAC;EAC1H,IAAIQ,MAAM,GAAG,CAACJ,SAAS,KAAK,MAAM,GAAG,CAACC,KAAK,GAAGD,SAAS,KAAK,OAAO,GAAGC,KAAK,GAAG,CAAC,EAAED,SAAS,KAAK,KAAK,GAAG,CAACG,KAAK,GAAGH,SAAS,KAAK,QAAQ,GAAGG,KAAK,GAAG,CAAC,CAAC;EACnJC,MAAM,GAAGpN,cAAc,CAACoN,MAAM,EAAER,SAAS,EAAEC,MAAM,CAAC;EAClD,OAAO/P,IAAI,CAACoQ,GAAG,CAACE,MAAM,CAAC,CAAC,CAAC,CAAC,GAAGtQ,IAAI,CAACoQ,GAAG,CAACE,MAAM,CAAC,CAAC,CAAC,CAAC,GAAGA,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,OAAO,GAAG,MAAM,GAAGA,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,QAAQ,GAAG,KAAK;AACxH;AACA;AACA;AACA;AACA;;AAGA,SAASC,eAAeA,CAACC,EAAE,EAAEC,EAAE,EAAElC,eAAe,EAAEE,EAAE,EAAE;EACpD,IAAI,CAAC+B,EAAE,IAAI,CAACC,EAAE,EAAE;IACd;EACF;EAEA,SAASC,QAAQA,CAACC,CAAC,EAAE;IACnB,IAAIC,KAAK,GAAG,CAAC,CAAC;IACdD,CAAC,CAAC7J,QAAQ,CAAC,UAAUxC,EAAE,EAAE;MACvB,IAAI,CAACA,EAAE,CAACmB,OAAO,IAAInB,EAAE,CAACuM,IAAI,EAAE;QAC1BD,KAAK,CAACtM,EAAE,CAACuM,IAAI,CAAC,GAAGvM,EAAE;MACrB;IACF,CAAC,CAAC;IACF,OAAOsM,KAAK;EACd;EAEA,SAASE,kBAAkBA,CAACxM,EAAE,EAAE;IAC9B,IAAIyM,GAAG,GAAG;MACRC,QAAQ,EAAExS,MAAM,CAACyS,KAAK,CAAC3M,EAAE,CAAC0M,QAAQ,CAAC;MACnCE,QAAQ,EAAE5M,EAAE,CAAC4M;IACf,CAAC;IAED,IAAI5M,EAAE,CAACd,KAAK,EAAE;MACZuN,GAAG,CAACvN,KAAK,GAAGrF,MAAM,CAAC8C,MAAM,CAAC,CAAC,CAAC,EAAEqD,EAAE,CAACd,KAAK,CAAC;IACzC;IAEA,OAAOuN,GAAG;EACZ;EAEA,IAAII,MAAM,GAAGT,QAAQ,CAACF,EAAE,CAAC;EACzBC,EAAE,CAAC3J,QAAQ,CAAC,UAAUxC,EAAE,EAAE;IACxB,IAAI,CAACA,EAAE,CAACmB,OAAO,IAAInB,EAAE,CAACuM,IAAI,EAAE;MAC1B,IAAIO,KAAK,GAAGD,MAAM,CAAC7M,EAAE,CAACuM,IAAI,CAAC;MAE3B,IAAIO,KAAK,EAAE;QACT,IAAIC,OAAO,GAAGP,kBAAkB,CAACxM,EAAE,CAAC;QACpCA,EAAE,CAAC6K,IAAI,CAAC2B,kBAAkB,CAACM,KAAK,CAAC,CAAC;QAClChC,WAAW,CAAC9K,EAAE,EAAE+M,OAAO,EAAE9C,eAAe,EAAEjK,EAAE,CAACkK,SAAS,CAAC;MACzD,CAAC,CAAC;MACF;MACA;MACA;MACA;IAEF;EACF,CAAC,CAAC;AACJ;AACA;AACA;AACA;AACA;AACA;;AAGA,SAAS8C,gBAAgBA,CAACC,MAAM,EAAE5P,IAAI,EAAE;EACtC;EACA;EACA,OAAOxD,MAAM,CAACqT,GAAG,CAACD,MAAM,EAAE,UAAUE,KAAK,EAAE;IACzC,IAAInP,CAAC,GAAGmP,KAAK,CAAC,CAAC,CAAC;IAChBnP,CAAC,GAAGvC,OAAO,CAACuC,CAAC,EAAEX,IAAI,CAACW,CAAC,CAAC;IACtBA,CAAC,GAAGpC,OAAO,CAACoC,CAAC,EAAEX,IAAI,CAACW,CAAC,GAAGX,IAAI,CAACa,KAAK,CAAC;IACnC,IAAID,CAAC,GAAGkP,KAAK,CAAC,CAAC,CAAC;IAChBlP,CAAC,GAAGxC,OAAO,CAACwC,CAAC,EAAEZ,IAAI,CAACY,CAAC,CAAC;IACtBA,CAAC,GAAGrC,OAAO,CAACqC,CAAC,EAAEZ,IAAI,CAACY,CAAC,GAAGZ,IAAI,CAACc,MAAM,CAAC;IACpC,OAAO,CAACH,CAAC,EAAEC,CAAC,CAAC;EACf,CAAC,CAAC;AACJ;AACA;AACA;AACA;AACA;AACA;;AAGA,SAASmP,cAAcA,CAACC,UAAU,EAAEhQ,IAAI,EAAE;EACxC,IAAIW,CAAC,GAAGvC,OAAO,CAAC4R,UAAU,CAACrP,CAAC,EAAEX,IAAI,CAACW,CAAC,CAAC;EACrC,IAAIsP,EAAE,GAAG1R,OAAO,CAACyR,UAAU,CAACrP,CAAC,GAAGqP,UAAU,CAACnP,KAAK,EAAEb,IAAI,CAACW,CAAC,GAAGX,IAAI,CAACa,KAAK,CAAC;EACtE,IAAID,CAAC,GAAGxC,OAAO,CAAC4R,UAAU,CAACpP,CAAC,EAAEZ,IAAI,CAACY,CAAC,CAAC;EACrC,IAAIsP,EAAE,GAAG3R,OAAO,CAACyR,UAAU,CAACpP,CAAC,GAAGoP,UAAU,CAAClP,MAAM,EAAEd,IAAI,CAACY,CAAC,GAAGZ,IAAI,CAACc,MAAM,CAAC,CAAC,CAAC;EAC1E;;EAEA,IAAImP,EAAE,IAAItP,CAAC,IAAIuP,EAAE,IAAItP,CAAC,EAAE;IACtB,OAAO;MACLD,CAAC,EAAEA,CAAC;MACJC,CAAC,EAAEA,CAAC;MACJC,KAAK,EAAEoP,EAAE,GAAGtP,CAAC;MACbG,MAAM,EAAEoP,EAAE,GAAGtP;IACf,CAAC;EACH;AACF;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,SAASuP,UAAUA,CAACC,OAAO,EAAEpJ,GAAG,EAAEhH,IAAI,EAAE;EACtCgH,GAAG,GAAGxK,MAAM,CAAC8C,MAAM,CAAC;IAClB+Q,SAAS,EAAE;EACb,CAAC,EAAErJ,GAAG,CAAC;EACP,IAAIvG,KAAK,GAAGuG,GAAG,CAACvG,KAAK,GAAG;IACtB6P,aAAa,EAAE;EACjB,CAAC;EACDtQ,IAAI,GAAGA,IAAI,IAAI;IACbW,CAAC,EAAE,CAAC,CAAC;IACLC,CAAC,EAAE,CAAC,CAAC;IACLC,KAAK,EAAE,CAAC;IACRC,MAAM,EAAE;EACV,CAAC;EAED,IAAIsP,OAAO,EAAE;IACX,OAAOA,OAAO,CAACjE,OAAO,CAAC,UAAU,CAAC,KAAK,CAAC,IAAI1L,KAAK,CAACC,KAAK,GAAG0P,OAAO,CAACG,KAAK,CAAC,CAAC,CAAC,EAAE/T,MAAM,CAACgU,QAAQ,CAAC/P,KAAK,EAAET,IAAI,CAAC,EAAE,IAAIhD,MAAM,CAACgK,GAAG,CAAC,IAAIjH,QAAQ,CAACqQ,OAAO,CAACK,OAAO,CAAC,SAAS,EAAE,EAAE,CAAC,EAAEzJ,GAAG,EAAEhH,IAAI,EAAE,QAAQ,CAAC;EAC5L;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,SAAS0Q,oBAAoBA,CAACC,GAAG,EAAEC,GAAG,EAAEC,GAAG,EAAEC,GAAG,EAAElB,MAAM,EAAE;EACxD,KAAK,IAAImB,CAAC,GAAG,CAAC,EAAEC,EAAE,GAAGpB,MAAM,CAACA,MAAM,CAACqB,MAAM,GAAG,CAAC,CAAC,EAAEF,CAAC,GAAGnB,MAAM,CAACqB,MAAM,EAAEF,CAAC,EAAE,EAAE;IACtE,IAAIG,CAAC,GAAGtB,MAAM,CAACmB,CAAC,CAAC;IAEjB,IAAII,iBAAiB,CAACR,GAAG,EAAEC,GAAG,EAAEC,GAAG,EAAEC,GAAG,EAAEI,CAAC,CAAC,CAAC,CAAC,EAAEA,CAAC,CAAC,CAAC,CAAC,EAAEF,EAAE,CAAC,CAAC,CAAC,EAAEA,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE;MACnE,OAAO,IAAI;IACb;IAEAA,EAAE,GAAGE,CAAC;EACR;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,SAASC,iBAAiBA,CAACR,GAAG,EAAEC,GAAG,EAAEC,GAAG,EAAEC,GAAG,EAAEM,GAAG,EAAEC,GAAG,EAAEC,GAAG,EAAEC,GAAG,EAAE;EACjE;EACA,IAAIC,EAAE,GAAGX,GAAG,GAAGF,GAAG;EAClB,IAAIc,EAAE,GAAGX,GAAG,GAAGF,GAAG;EAClB,IAAIc,EAAE,GAAGJ,GAAG,GAAGF,GAAG;EAClB,IAAIO,EAAE,GAAGJ,GAAG,GAAGF,GAAG,CAAC,CAAC;EACpB;;EAEA,IAAIO,cAAc,GAAGC,cAAc,CAACH,EAAE,EAAEC,EAAE,EAAEH,EAAE,EAAEC,EAAE,CAAC;EAEnD,IAAIK,QAAQ,CAACF,cAAc,CAAC,EAAE;IAC5B,OAAO,KAAK;EACd,CAAC,CAAC;EACF;EACA;EACA;;EAGA,IAAIG,KAAK,GAAGpB,GAAG,GAAGS,GAAG;EACrB,IAAIY,KAAK,GAAGpB,GAAG,GAAGS,GAAG;EACrB,IAAIY,CAAC,GAAGJ,cAAc,CAACE,KAAK,EAAEC,KAAK,EAAER,EAAE,EAAEC,EAAE,CAAC,GAAGG,cAAc;EAE7D,IAAIK,CAAC,GAAG,CAAC,IAAIA,CAAC,GAAG,CAAC,EAAE;IAClB,OAAO,KAAK;EACd;EAEA,IAAIf,CAAC,GAAGW,cAAc,CAACE,KAAK,EAAEC,KAAK,EAAEN,EAAE,EAAEC,EAAE,CAAC,GAAGC,cAAc;EAE7D,IAAIV,CAAC,GAAG,CAAC,IAAIA,CAAC,GAAG,CAAC,EAAE;IAClB,OAAO,KAAK;EACd;EAEA,OAAO,IAAI;AACb;AACA;AACA;AACA;;AAGA,SAASW,cAAcA,CAACK,EAAE,EAAEC,EAAE,EAAElC,EAAE,EAAEC,EAAE,EAAE;EACtC,OAAOgC,EAAE,GAAGhC,EAAE,GAAGD,EAAE,GAAGkC,EAAE;AAC1B;AAEA,SAASL,QAAQA,CAACM,GAAG,EAAE;EACrB,OAAOA,GAAG,IAAI,IAAI,IAAIA,GAAG,IAAI,CAAC,IAAI;AACpC,CAAC,CAAC;AACF;;AAGA1S,aAAa,CAAC,QAAQ,EAAErC,MAAM,CAAC;AAC/BqC,aAAa,CAAC,QAAQ,EAAEpC,MAAM,CAAC;AAC/BoC,aAAa,CAAC,MAAM,EAAEnC,IAAI,CAAC;AAC3BmC,aAAa,CAAC,SAAS,EAAElC,OAAO,CAAC;AACjCkC,aAAa,CAAC,UAAU,EAAEjC,QAAQ,CAAC;AACnCiC,aAAa,CAAC,MAAM,EAAEhC,IAAI,CAAC;AAC3BgC,aAAa,CAAC,MAAM,EAAE/B,IAAI,CAAC;AAC3B+B,aAAa,CAAC,aAAa,EAAE9B,WAAW,CAAC;AACzC8B,aAAa,CAAC,KAAK,EAAE7B,GAAG,CAAC;AACzBZ,OAAO,CAACyB,gBAAgB,GAAGA,gBAAgB;AAC3CzB,OAAO,CAAC0B,6BAA6B,GAAGA,6BAA6B;AACrE1B,OAAO,CAACmC,WAAW,GAAGA,WAAW;AACjCnC,OAAO,CAACsC,UAAU,GAAGA,UAAU;AAC/BtC,OAAO,CAACyC,aAAa,GAAGA,aAAa;AACrCzC,OAAO,CAAC4C,aAAa,GAAGA,aAAa;AACrC5C,OAAO,CAAC8C,QAAQ,GAAGA,QAAQ;AAC3B9C,OAAO,CAACsD,SAAS,GAAGA,SAAS;AAC7BtD,OAAO,CAACqE,SAAS,GAAGA,SAAS;AAC7BrE,OAAO,CAACqD,UAAU,GAAGA,UAAU;AAC/BrD,OAAO,CAAC0E,oBAAoB,GAAGA,oBAAoB;AACnD1E,OAAO,CAAC6E,oBAAoB,GAAGA,oBAAoB;AACnD7E,OAAO,CAAC8E,gBAAgB,GAAGA,gBAAgB;AAC3C9E,OAAO,CAACqI,oBAAoB,GAAGA,oBAAoB;AACnDrI,OAAO,CAACgJ,aAAa,GAAGA,aAAa;AACrChJ,OAAO,CAACiJ,uBAAuB,GAAGA,uBAAuB;AACzDjJ,OAAO,CAACwJ,oBAAoB,GAAGA,oBAAoB;AACnDxJ,OAAO,CAACyJ,iBAAiB,GAAGA,iBAAiB;AAC7CzJ,OAAO,CAAC2J,aAAa,GAAGA,aAAa;AACrC3J,OAAO,CAACkL,gBAAgB,GAAGA,gBAAgB;AAC3ClL,OAAO,CAACgL,YAAY,GAAGA,YAAY;AACnChL,OAAO,CAAC0L,OAAO,GAAGA,OAAO;AACzB1L,OAAO,CAACoP,OAAO,GAAGA,OAAO;AACzBpP,OAAO,CAACwQ,WAAW,GAAGA,WAAW;AACjCxQ,OAAO,CAACyQ,SAAS,GAAGA,SAAS;AAC7BzQ,OAAO,CAAC0Q,YAAY,GAAGA,YAAY;AACnC1Q,OAAO,CAACsE,cAAc,GAAGA,cAAc;AACvCtE,OAAO,CAACqR,kBAAkB,GAAGA,kBAAkB;AAC/CrR,OAAO,CAAC2R,eAAe,GAAGA,eAAe;AACzC3R,OAAO,CAAC0S,gBAAgB,GAAGA,gBAAgB;AAC3C1S,OAAO,CAAC8S,cAAc,GAAGA,cAAc;AACvC9S,OAAO,CAACkT,UAAU,GAAGA,UAAU;AAC/BlT,OAAO,CAACyT,oBAAoB,GAAGA,oBAAoB;AACnDzT,OAAO,CAACkU,iBAAiB,GAAGA,iBAAiB"},"metadata":{},"sourceType":"script","externalDependencies":[]}